import{r as e,a as s,g as t}from"../js/chunk-BAuh0hMg.js";import{r as n,T as o,I as a,D as l,M as i,d as r,e as c,S as d,L as m,f as u,g as h,h as p,i as g,j as x,C as f,k as y,F as b,l as j,m as v,B as k,P as M,n as S,o as C,E as I,A as R,p as w,q as N,s as D,t as T,u as E,R as L}from"../js/chunk-Cpu70hGG.js";import{v as P,u as $,a as A,b as z,c as B,L as F,S as O,O as _,H as V,d as U,R as K,e as q,f as H,g as W,N as Q}from"../js/chunk-CXrSJFwn.js";import{m as G,r as J,o as Z,t as Y}from"../js/chunk-Ddkm1DPK.js";import{R as X,L as ee,a as se,C as te,X as ne,Y as oe,T as ae,b as le}from"../js/chunk-Cxc9XNaW.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&s(e)}).observe(document,{childList:!0,subtree:!0})}function s(e){if(e.ep)return;e.ep=!0;const s=function(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerPolicy&&(s.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?s.credentials="include":"anonymous"===e.crossOrigin?s.credentials="omit":s.credentials="same-origin",s}(e);fetch(e.href,s)}}();var ie,re,ce={exports:{}},de={};var me,ue=(re||(re=1,ce.exports=function(){if(ie)return de;ie=1;var s=e(),t=Symbol.for("react.element"),n=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function i(e,s,n){var i,r={},c=null,d=null;for(i in void 0!==n&&(c=""+n),void 0!==s.key&&(c=""+s.key),void 0!==s.ref&&(d=s.ref),s)o.call(s,i)&&!l.hasOwnProperty(i)&&(r[i]=s[i]);if(e&&e.defaultProps)for(i in s=e.defaultProps)void 0===r[i]&&(r[i]=s[i]);return{$$typeof:t,type:e,key:c,ref:d,props:r,_owner:a.current}}return de.Fragment=n,de.jsx=i,de.jsxs=i,de}()),ce.exports),he={};const pe=t(function(){if(me)return he;me=1;var e=s();return he.createRoot=e.createRoot,he.hydrateRoot=e.hydrateRoot,he}()),ge=n.createContext({commonContext:{nodeName:"",os:"",architecture:"",cpuCores:0,CRC32:"",release:"",commit:"",productName:""},setCommonContext:()=>{}}),xe=()=>n.useContext(ge),fe=({children:e})=>{const[s,t]=n.useState({nodeName:"",os:"",architecture:"",cpuCores:0,CRC32:"",release:"",commit:"",productName:""});return ue.jsx(ge.Provider,{value:{commonContext:s,setCommonContext:t},children:e})},ye=({children:e})=>ue.jsx("div",{style:{display:"flex",justifyContent:"space-between"},children:e}),be=({children:e})=>ue.jsx("div",{style:{width:"45%"},children:e});class je{socket=null;connected=!1;callbacks=[];constructor(){G(this)}connectionLost=!1;addCallback({type:e,fn:s}){this.callbacks.push({type:e,fn:s})}removeCallback({type:e}){this.callbacks=this.callbacks.filter(s=>s.type!==e)}startSocket(){const e=`ws://${location.host}/ws`;this.socket=new WebSocket(e),this.socket.onclose=()=>{J(()=>{this.connected=!1,this.connectionLost=!0})},this.socket.onopen=()=>{J(()=>{this.connected=!0,this.connectionLost=!1})},this.socket.onmessage=e=>{this.readMessage(e)}}sendConnectCommand(){this.sendMessage('{"Command": "connect"}')}connectByNodename(e){this.sendMessage(`{"Command": "connect", "Name": "${e}"}`)}sendMessage(e){this.socket&&this.connected&&this.socket.send(e)}readSocket(){this.sendConnectCommand()}readMessage(e){let s;try{s=JSON.parse(e.data)}catch(t){return}for(const{type:n,fn:o}of this.callbacks)try{o(s)}catch(t){console.error(`❌ WebSocketStore: Error in callback ${n}:`,t)}}}const ve=e=>"object"==typeof e&&!Array.isArray(e)&&null!==e,ke=e=>void 0!==e.Event||void 0!==e.Result,Me=e=>ve(e)&&ke(e)&&"string"==typeof e?.Event&&e.Event.includes("inspect_node"),Se=e=>ve(e)&&ke(e)&&void 0!==e.Result&&"object"==typeof e.Result&&"string"==typeof(e?.Result).Event&&e.Result.Event.includes("inspect_node"),Ce=e=>ve(e)&&ke(e)&&"string"==typeof e?.Message&&"terminated"===e.Message,Ie=e=>ve(e)&&"string"==typeof e.CID&&"string"==typeof e.Error;class Re{logs=[];processLogs=[];metaProcessLogs=[];logLevels=["info","warning","error","panic"];logsToRender=[];processLogsToRender=[];metaProcessLogsToRender=[];resultEvent;pauseLogs=!1;lastCount=100;processLastCount=100;metaProcessLastCount=100;interval=null;websocketStore;nodeStore;filter=()=>!0;processFilter=()=>!0;metaProcessFilter=()=>!0;constructor(e,s){G(this,{logs:!1,processLogs:!1,metaProcessLogs:!1}),this.websocketStore=e,this.nodeStore=s,this.startCollectLogs(),this.startSyncLogs(),this.inspectLogPageResult()}setLogLevels(e){this.logLevels=e}setLogsToRender(){this.logsToRender=this.logs,this.processLogsToRender=this.processLogs,this.metaProcessLogsToRender=this.metaProcessLogs}setPauseLogs(e){this.pauseLogs=e}setLastCount(e){this.lastCount=e}setProcessLastCount(e){this.processLastCount=e}setMetaProcessLastCount(e){this.metaProcessLastCount=e}startSyncLogs(){this.interval&&clearInterval(this.interval),this.interval=setInterval(()=>{this.pauseLogs||this.setLogsToRender()},1e3)}stopSyncLogs(){this.interval&&clearInterval(this.interval)}setLogsFilter(e){this.filter=e}setProcessFilter(e){this.processFilter=e}setMetaProcessFilter(e){this.metaProcessFilter=e}clearLogFilter(){this.filter=()=>!0}clearLogs(){this.logs=[],this.logsToRender=[]}clearProcessLogs(){this.processLogs=[],this.processLogsToRender=[]}clearMetaProcessLogs(){this.metaProcessLogs=[],this.metaProcessLogsToRender=[]}clearAllLogs(){this.clearLogs(),this.clearProcessLogs(),this.clearMetaProcessLogs()}setResultEvent(e){this.resultEvent=e}inspectLogPageResult(){this.websocketStore?.addCallback({type:"inspectLogPageResult",fn:e=>{var s;ve(s=e)&&ke(s)&&void 0!==s.Result&&"object"==typeof s.Result&&"string"==typeof(s?.Result).Event&&s.Result.Event.includes("inspect_log")&&this.setResultEvent(e.Result.Event)}})}unsubscribeLogData(){this.resultEvent&&(this.websocketStore?.sendMessage(`{\n        "CID": "${P()}",\n        "Command": "unsubscribe",\n        "Name": "${this.resultEvent}"\n      }`),this.setResultEvent(void 0))}tryToSubscribeLogData(){if(!this.pauseLogs)if(this.nodeStore?.nodeData?.Message.Info.Name)this.resultEvent&&this.websocketStore?.sendMessage(`{\n          "CID": "${P()}",\n          "Command": "unsubscribe",\n          "Name": "${this.resultEvent}"\n        }`),this.websocketStore?.sendMessage(`{\n        "CID": "${P()}",\n        "Command": "subscribe",\n        "Name": "log",\n        "Args": {\n            "Levels": ${JSON.stringify(this.logLevels)}\n        }\n    }`);else{const e=setTimeout(()=>{this.tryToSubscribeLogData(),clearTimeout(e)},200)}}startCollectLogs(){this.websocketStore?.addCallback({type:"startCollectLogs",fn:e=>{var s;if(!this.pauseLogs&&(ve(s=e)&&ke(s)&&"string"==typeof s?.Event&&s.Event.includes("inspect_log"))){if(J(()=>{this.logs.push(e),this.processLogs.push(e),this.metaProcessLogs.push(e)}),this.logs=this.logs.filter(this.filter),this.logs.length>this.lastCount){const e=this.logs.length-this.lastCount;J(()=>{this.logs.splice(0,e)})}if(this.processLogs=this.processLogs.filter(this.processFilter),this.processLogs.length>this.processLastCount){const e=this.processLogs.length-this.processLastCount;J(()=>{this.processLogs.splice(0,e)})}if(this.metaProcessLogs=this.metaProcessLogs.filter(this.metaProcessFilter),this.metaProcessLogs.length>this.metaProcessLastCount){const e=this.metaProcessLogs.length-this.metaProcessLastCount;J(()=>{this.metaProcessLogs.splice(0,e)})}}}})}}const{Text:we}=o,{TextArea:Ne}=a,De=[{key:"send",label:"Send Message..."},{key:"send_exit",label:"Send Exit-signal..."},{key:"kill",label:"Kill"}],Te=[{label:"Normal",value:"normal"},{label:"High",value:"high"},{label:"Max",value:"max"}],Ee=Z(()=>{const{websocketStore:e}=zs(),{pid:s}=$(),[t,o]=n.useState(""),[a,m]=n.useState(""),[u,h]=n.useState(""),[p,g]=n.useState(""),[x,f]=n.useState("normal"),y=()=>{o(""),m(""),h(""),g("")};return ue.jsxs(ue.Fragment,{children:[ue.jsx(l,{menu:{items:De,selectedKeys:[],onSelect:e=>{o(e.key)},selectable:!0},trigger:["click"],children:ue.jsx(i,{style:{paddingRight:"20px"}})}),ue.jsx(r,{title:ue.jsx("div",{children:ue.jsx("div",{children:ue.jsx(we,{type:"secondary",style:{fontSize:16},children:"Send Message"})})}),open:"send"===t,onOk:()=>{e.sendMessage(`\n          {\n            "CID": "${P()}",\n            "Command": "do",\n            "Name": "send",\n            "Args":\n              {"PID":"${s}", "Message":"${a}", "Priority":"${x}"}\n        }\n          `),y()},okText:"Send",onCancel:()=>{y()},closable:!1,children:ue.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"5px"},children:[ue.jsxs(ye,{children:[ue.jsxs("span",{children:[ue.jsx(we,{type:"secondary",children:"To:"})," ",ue.jsx(we,{children:s})]}),ue.jsxs("span",{children:[ue.jsx(we,{type:"secondary",children:"Priority:"})," ",ue.jsx(c.Group,{options:Te,onChange:e=>{const s=e.target.value;f(s)},value:x,optionType:"button",buttonStyle:"solid",size:"small"})]})]}),ue.jsx(Ne,{value:a,onChange:e=>m(e.target.value),placeholder:"enter message here",autoSize:{minRows:3,maxRows:5},ref:e=>{setTimeout(()=>e?.focus(),0)}})]})}),ue.jsx(r,{title:ue.jsx("div",{children:ue.jsx("div",{children:ue.jsx(we,{type:"secondary",style:{fontSize:16},children:"Send Exit-signal"})})}),open:"send_exit"===t,onOk:()=>{e.sendMessage(`\n          {\n            "CID": "${P()}",\n            "Command": "do",\n            "Name": "send_exit",\n            "Args":\n              {"PID":"${s}", "Reason": "${"custom"===p?u:p}"}\n        }\n          `),y()},okText:"Send Exit",onCancel:()=>{y()},closable:!1,okButtonProps:{danger:!0},children:ue.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"5px"},children:[ue.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[ue.jsxs("span",{children:[ue.jsx(we,{type:"secondary",children:"To:"})," ",ue.jsx(we,{children:s})]}),ue.jsxs("span",{children:[ue.jsx(we,{type:"secondary",children:"Reason:"})," ",ue.jsx(d,{defaultValue:"normal",style:{width:120},onChange:e=>{g(e)},options:[{value:"normal",label:"normal"},{value:"shutdown",label:"shutdown"},{value:"custom",label:"custom..."}]})]})]}),ue.jsx(Ne,{disabled:"custom"!==p,value:u,onChange:e=>h(e.target.value),placeholder:"enter reason here",autoSize:{minRows:1,maxRows:5},ref:e=>{setTimeout(()=>e?.focus(),0)}}),ue.jsx(we,{type:"secondary",children:"Exit-signal makes the process perform a graceful shutdown. Process based on act.Actor might enable TrapExit, transforming this signal into a regular message gen.MessageExit."})]})}),ue.jsxs(r,{title:ue.jsx(we,{type:"secondary",style:{fontSize:16},children:"Kill process"}),open:"kill"===t,onOk:()=>{e.sendMessage(`\n          {\n            "CID": "${P()}",\n            "Command": "do",\n            "Name": "kill",\n            "Args":\n              {"PID":"${s}"}\n        }\n          `),y()},okText:"Kill",onCancel:()=>{y()},closable:!1,okButtonProps:{danger:!0},children:[ue.jsx(we,{type:"secondary",children:"Please confirm you want to kill:"})," ",ue.jsx(we,{children:s})]})]})}),{Text:Le,Link:Pe}=o,$e=({processData:e})=>{const s=A(),t="default"!==z().key,n=B("/:crc/process/:pid/*"),o=[n?.params["*"]],{pid:a,crc:l}=$();return ue.jsx("div",{style:{height:"50px",marginTop:"5px",marginLeft:"20px"},children:ue.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[ue.jsxs("div",{children:[ue.jsxs(Pe,{style:{textDecoration:"none"},onClick:()=>s(t?-1:`/${l}/info`),children:[ue.jsx(m,{style:{color:"#7d7d7d"}})," "]}),ue.jsx(Le,{style:{fontSize:"16px",color:"#7d7d7d"},children:"Process"})," ",ue.jsx(Le,{style:{fontSize:"16px"},children:e?.Message.Info.PID})]}),ue.jsxs("div",{style:{flexGrow:1,display:"flex",justifyContent:"end"},children:[ue.jsx("div",{style:{width:"200px"},children:ue.jsx(u,{onClick:()=>{},selectedKeys:o,expandIcon:!1,mode:"horizontal",items:[{label:ue.jsx(Le,{style:{fontSize:"14px",color:"#7d7d7d"},children:ue.jsx(F,{to:`/${l}/process/${a}/info`,children:"Info"})}),key:"info"},{label:ue.jsx(Le,{style:{fontSize:"14px",color:"#7d7d7d"},children:ue.jsx(F,{to:`/${l}/process/${a}/inspect`,children:"Inspect"})}),key:"inspect"},{label:ue.jsx(Le,{style:{fontSize:"14px",color:"#7d7d7d"},children:ue.jsx(F,{to:`/${l}/process/${a}/log`,children:"Log"})}),key:"log"}]})}),ue.jsx(Ee,{})]})]})})},Ae=e=>e?"true":"false",ze=[{key:"trace",label:"trace",disabled:!0},{key:"debug",label:"debug"},{key:"info",label:"info"},{key:"warning",label:"warning"},{key:"error",label:"error"},{key:"panic",label:"panic"},{key:"disabled",label:"disabled"}],Be=Z(({logLevel:e})=>{const{websocketStore:s}=zs();return ue.jsx(l,{menu:{items:ze,selectedKeys:[e],onSelect:e=>{var t;t=e.key,s.sendMessage(`\n    {\n      "CID": "${P()}",\n      "Command": "do",\n      "Name": "set_log_level",\n      "Args":\n        {"Level":"${t}"}\n  }\n  `)},selectable:!0},trigger:["click"],children:ue.jsxs(o.Link,{children:[ze.find(s=>s.key===e)?.label," ",ue.jsx(h,{})]})})}),Fe=Z(({logLevel:e})=>{const{websocketStore:s}=zs(),{pid:t}=$();return ue.jsx(l,{menu:{items:ze,selectedKeys:[e],onSelect:e=>{var n;n=e.key,s.sendMessage(`\n    {\n      "CID": "${P()}",\n      "Command": "do",\n      "Name": "set_log_level",\n      "Args":\n        {"Level":"${n}", "PID":"${t}"}\n  }\n  `)},selectable:!0},trigger:["click"],children:ue.jsxs(o.Link,{children:[ze.find(s=>s.key===e)?.label," ",ue.jsx(h,{})]})})}),Oe=({pid:e,CRC32:s,crc:t})=>{if(e.endsWith(".0.1>"))return e;if(((e,s)=>!e.includes(s))(e,s))return e;if((e=>e.startsWith("Alias"))(e)){const s=e.replace("#","%23");return ue.jsx(F,{to:`/${t}/meta_process/${s}/info`,children:e})}return ue.jsx(F,{to:`/${t}/process/${e}/info`,children:e})},_e=()=>{const{commonContext:{CRC32:e}}=xe(),{crc:s="default"}=$();return({pid:t})=>ue.jsx(Oe,{pid:t,CRC32:e,crc:s})},Ve=({uptime:e})=>{const s=Number(e),t=new Date(1e3*Number(s)).toISOString().substring(11,19),n=Math.floor(Number(s)/86400),o="00"===t.substring(0,2)?"0":t.substring(0,2),a="00"==t.substring(3,5)?"0":t.substring(3,5);return ue.jsx(p,{title:`${n} days ${o} hours ${a} minutes`,children:s})},{Text:Ue}=o,Ke=n.memo(()=>ue.jsx(Ue,{style:{color:"#50b669",fontSize:12},children:"remote"}));Ke.displayName="RemoteBadge";const qe=n.memo(({process:e,CRC32:s})=>{const t=_e(),o=n.useMemo(()=>[{key:"0",label:"Behavior",children:e.Behavior},{key:"1",label:"Application",children:e.Application},{key:"2",label:"Parent",children:e.Parent&&ue.jsxs("span",{children:[!e.Parent.includes(s)&&ue.jsx(Ke,{})," ",ue.jsx(t,{pid:e.Parent})]})},{key:"3",label:"Leader",children:e.Leader&&ue.jsxs("span",{children:[!e.Leader.includes(s)&&ue.jsx(Ke,{})," ",ue.jsx(t,{pid:e.Leader})]})},{key:"4",label:"Log Level",children:e.LogLevel}],[e.Behavior,e.Application,e.Parent,e.Leader,e.LogLevel,s,t]),a=n.useMemo(()=>[{key:"0",label:"Messages In",children:e.MessagesIn},{key:"2",label:"Messages Out",children:e.MessagesOut},{key:"3",label:"Messages Mailbox",children:e.MessagesMailbox},{key:"1",label:"State",children:e.State},{key:"4",label:"Running Time (nsec)",children:e.RunningTime}],[e.MessagesIn,e.MessagesOut,e.MessagesMailbox,e.State,e.RunningTime]);return ue.jsxs(ye,{children:[ue.jsx(be,{children:ue.jsx(g,{colon:!0,size:"small",items:o,column:1,layout:"horizontal"})}),ue.jsx(be,{children:ue.jsx(g,{colon:!0,size:"small",items:a,column:1,layout:"horizontal"})})]})});qe.displayName="ProcessContent";const He=Z(()=>{const{commonContext:{CRC32:e}}=xe(),{processesStore:s}=zs(),[t,o]=n.useState(s.startFrom),[a,l]=n.useState(s.limit),i=n.useRef(!0);n.useEffect(()=>{i.current?i.current=!1:s.tryToSubscribeProcessListData()},[a,t,s]);const r=n.useMemo(()=>[{value:"pid",label:"PID"},{value:"topRunning",label:"Top Running"},{value:"topMessaging",label:"Top Messaging"},{value:"topMailbox",label:"Top Mailbox"}],[]),[d,m]=n.useState(s.sort),u=_e(),h=n.useMemo(()=>[...s.processListDataToRender?.Message.Processes??[]].sort((e=>"pid"===e?()=>0:"topRunning"===e?(e,s)=>s.RunningTime-e.RunningTime:"topMessaging"===e?(e,s)=>{const t=e.MessagesIn+e.MessagesOut;return s.MessagesIn+s.MessagesOut-t}:"topMailbox"===e?(e,s)=>s.MessagesMailbox-e.MessagesMailbox:()=>0)(d)),[s.processListDataToRender?.Message.Processes,d]),p=n.useMemo(()=>h.map(s=>({key:s.PID,label:ue.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[ue.jsxs("div",{children:[ue.jsx(u,{pid:s.PID})," ",s.Name]}),ue.jsxs("div",{style:{color:"#7d7d7d"},children:[" ",s.Behavior]})]}),children:ue.jsx(qe,{process:s,CRC32:e})})),[h,u,e]),g=n.useCallback(e=>{const t=e??1001;o(t),s.setStartFrom(t)},[s]),y=n.useCallback(e=>{const t=e??1;l(t),s.setLimit(t)},[s]),b=n.useCallback(e=>{const t=e.target.value;m(t),s.setSort(t)},[s]),j=n.useMemo(()=>({display:"flex",justifyContent:"space-between"}),[]),v=n.useMemo(()=>({display:"flex",justifyContent:"flex-end",alignContent:"center",alignItems:"center"}),[]),k=n.useMemo(()=>({padding:0,margin:0,width:"60px"}),[]),M=n.useMemo(()=>({padding:0,margin:0,width:"30px"}),[]),S=n.useMemo(()=>({color:"#a0a0a0"}),[]);return ue.jsxs("div",{children:[ue.jsxs("div",{style:j,children:[ue.jsxs("div",{style:v,children:[ue.jsxs("div",{children:[ue.jsx(Ue,{style:S,children:`Start from: <${e}.0.`}),ue.jsx(x,{min:1001,variant:"borderless",value:t,onChange:g,controls:!1,style:k}),ue.jsx(Ue,{style:S,children:">"})]}),"     ",ue.jsxs("div",{children:[ue.jsx(Ue,{style:S,children:"Limit:"}),ue.jsx(x,{placeholder:"3",variant:"borderless",value:a,min:1,onChange:y,controls:!1,style:M})]})]}),ue.jsxs("div",{children:[ue.jsx(Ue,{style:S,children:"Sort: "}),ue.jsx(c.Group,{options:r,onChange:b,value:d,optionType:"button",buttonStyle:"solid",size:"small"})]})]}),ue.jsx(f,{items:p})]})});He.displayName="ProcessesTabContent";const We=({processData:e})=>{const s=_e(),{commonContext:{CRC32:t}}=xe();return ue.jsxs(ye,{children:[ue.jsx(be,{children:ue.jsx(g,{colon:!1,size:"small",items:[{key:"1",label:"Behavior",children:e?.Message.Info.Behavior},{key:"10",label:"Registered Name",children:e?.Message.Info.Name},{key:"11",label:"Application",children:e?.Message.Info.Application},{key:"2",label:"Parent",children:e?.Message.Info.Parent&&ue.jsxs("span",{children:[!e.Message.Info.Parent.includes(t)&&ue.jsx(Ke,{})," ",ue.jsx(s,{pid:e?.Message.Info.Parent})]})},{key:"3",label:"Leader",children:e?.Message.Info.Leader&&ue.jsxs("span",{children:[!e.Message.Info.Leader.includes(t)&&ue.jsx(Ke,{})," ",ue.jsx(s,{pid:e?.Message.Info.Leader})]})},{key:"4",label:"Log Level",children:e?.Message.Info.LogLevel&&ue.jsx(Fe,{logLevel:e.Message.Info.LogLevel})},{key:"5",label:"State",children:e?.Message.Info.State},{key:"6",label:"Uptime",children:e?.Message.Info.Uptime&&ue.jsx(Ve,{uptime:e.Message.Info.Uptime})},{key:"6",label:"Running Time (nsec)",children:e?.Message.Info.RunningTime},{key:"7",label:"Mailbox Size",children:-1===e?.Message.Info.MailboxSize?"unlimited":e?.Message.Info.MailboxSize},{key:"8",label:"Message Priority",children:e?.Message.Info.MessagePriority}],column:1})}),ue.jsxs(be,{children:[ue.jsx(g,{colon:!1,size:"small",items:[{key:"9",label:"Keep Network Order",children:Ae(e?.Message.Info.KeepNetworkOrder)},{key:"10",label:"Important Delivery",children:Ae(e?.Message.Info.ImportantDelivery)}],column:1}),ue.jsx(y,{orientation:"left",plain:!0,style:{margin:0,color:"#7d7d7d"},children:"fallback"}),ue.jsx(g,{colon:!0,size:"small",items:[{key:"0",label:"Enable",children:Ae(e?.Message.Info.Fallback.Enable)},{key:"1",label:"Process Name",children:e?.Message.Info.Fallback.Name},{key:"2",label:"Tag",children:e?.Message.Info.Fallback.Tag}],column:1,layout:"horizontal"}),ue.jsx("div",{style:{margin:"10px"}}),ue.jsx(y,{orientation:"left",plain:!0,style:{margin:0,color:"#7d7d7d"},children:"compression"}),ue.jsx(g,{colon:!0,size:"small",items:[{key:"0",label:"Enable",children:Ae(e?.Message.Info.Compression.Enable)},{key:"1",label:"Type",children:e?.Message.Info.Compression.Type},{key:"2",label:"Level",children:e?.Message.Info.Compression.Level},{key:"3",label:"Threshold (bytes)",children:e?.Message.Info.Compression.Threshold}],column:1,layout:"horizontal"})]})]})},Qe="Iosevka Web, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'",{Text:Ge}=o,Je={messagesIn:"in",messagesOut:"out",bytesIn:"in",bytesOut:"out",queueMain:"main",queueSystem:"system",queueUrgent:"urgent",queueLog:"log"},Ze=({chartBuffer:e})=>ue.jsx("div",{style:{backgroundColor:"#262e35",padding:"10px",borderRadius:"10px",fontFamily:Qe},children:ue.jsx(X,{height:200,width:"100%",children:ue.jsxs(ee,{data:e,children:[ue.jsx(se,{style:{fontFamily:Qe,fontSize:14},formatter:e=>ue.jsx(Ge,{style:{color:"whitesmoke"},children:Je[e]}),align:"right",verticalAlign:"top",wrapperStyle:{paddingBottom:"5px"}}),ue.jsx(te,{strokeDasharray:"1 2",opacity:.5}),ue.jsx(ne,{dataKey:"xValue",fontFamily:Qe,fontSize:"9pt",type:"number",reversed:!0,tickCount:7,unit:"s"}),ue.jsx(oe,{fontFamily:Qe,fontSize:"9pt",type:"number",allowDecimals:!1}),ue.jsx(ae,{}),ue.jsx(le,{type:"monotone",dataKey:"messagesIn",stroke:"#dc695d",strokeWidth:2,isAnimationActive:!1,dot:ue.jsx(ue.Fragment,{}),connectNulls:!0}),ue.jsx(le,{type:"monotone",dataKey:"messagesOut",stroke:"#5db9dc",strokeWidth:2,isAnimationActive:!1,dot:ue.jsx(ue.Fragment,{}),connectNulls:!0})]})})}),Ye=({chartBuffer:e})=>ue.jsx("div",{style:{backgroundColor:"#262e35",padding:"10px",borderRadius:"10px",fontFamily:Qe},children:ue.jsx(X,{height:200,width:"100%",children:ue.jsxs(ee,{data:e,children:[ue.jsx(se,{style:{fontFamily:Qe,fontSize:14},formatter:e=>ue.jsx(Ge,{style:{color:"whitesmoke"},children:Je[e]}),align:"right",verticalAlign:"top",wrapperStyle:{paddingBottom:"5px"}}),ue.jsx(te,{strokeDasharray:"1 2",opacity:.5}),ue.jsx(ne,{dataKey:"xValue",fontFamily:Qe,fontSize:"9pt",type:"number",reversed:!0,tickCount:7,unit:"s"}),ue.jsx(oe,{fontFamily:Qe,fontSize:"9pt",type:"number",allowDecimals:!1}),ue.jsx(ae,{}),ue.jsx(le,{type:"monotone",dataKey:"queueMain",stroke:"#dcd75d",strokeWidth:2,isAnimationActive:!1,dot:ue.jsx(ue.Fragment,{}),connectNulls:!0}),ue.jsx(le,{type:"monotone",dataKey:"queueSystem",stroke:"#5ddc8b",strokeWidth:2,isAnimationActive:!1,dot:ue.jsx(ue.Fragment,{}),connectNulls:!0}),ue.jsx(le,{type:"monotone",dataKey:"queueUrgent",stroke:"#dc695d",strokeWidth:2,isAnimationActive:!1,dot:ue.jsx(ue.Fragment,{}),connectNulls:!0}),ue.jsx(le,{type:"monotone",dataKey:"queueLog",stroke:"#5db9dc",strokeWidth:2,isAnimationActive:!1,dot:ue.jsx(ue.Fragment,{}),connectNulls:!0})]})})}),Xe=({chartBuffer:e})=>ue.jsx("div",{style:{backgroundColor:"#262e35",padding:"10px",borderRadius:"10px",fontFamily:Qe},children:ue.jsx(X,{height:200,width:"100%",children:ue.jsxs(ee,{data:e,children:[ue.jsx(se,{style:{fontFamily:Qe,fontSize:14},formatter:e=>ue.jsx(Ge,{style:{color:"whitesmoke"},children:Je[e]}),align:"right",verticalAlign:"top",wrapperStyle:{paddingBottom:"5px"}}),ue.jsx(te,{strokeDasharray:"1 2",opacity:.5}),ue.jsx(ne,{dataKey:"xValue",fontFamily:Qe,fontSize:"9pt",type:"number",reversed:!0,tickCount:7,unit:"s"}),ue.jsx(oe,{fontFamily:Qe,fontSize:"9pt",type:"number",allowDecimals:!1}),ue.jsx(ae,{}),ue.jsx(le,{type:"monotone",dataKey:"queueMain",stroke:"#dcd75d",strokeWidth:2,isAnimationActive:!1,dot:ue.jsx(ue.Fragment,{}),connectNulls:!0}),ue.jsx(le,{type:"monotone",dataKey:"queueSystem",stroke:"#5ddc8b",strokeWidth:2,isAnimationActive:!1,dot:ue.jsx(ue.Fragment,{}),connectNulls:!0})]})})}),es=e=>new Date(e/1e6).getTime(),ss=e=>{const s=new Date(e/1e6);let t=s.getSeconds();t<10&&(t="0"+t);let n=s.getMinutes();n<10&&(n="0"+n);let o=s.getHours();o<10&&(o="0"+o);let a=s.getDate();a<10&&(a="0"+a);let l=s.getMonth()+1;l<10&&(l="0"+l);let i=s.getFullYear()%100;return i<10&&(i="0"+i),`${a}.${l}.${i} ${o}:${n}:${t}`},ts=({title:e})=>ue.jsx(y,{orientation:"left",plain:!0,style:{margin:"10px 0 5px 0 ",color:"#7d7d7d"},children:e}),{Text:ns}=o,os=({processData:e})=>{const{Aliases:s,Metas:t,Events:o}=e?.Message.Info??{},a=[{label:"Alias",description:"created using gen.Process.CreateAlias()",data:s??[]},{label:"Event",description:"registered using gen.Process.RegisterEvent(...)",data:o??[]},{label:"Meta",description:"spawned using gen.Process.SpawnMeta(...)",data:t??[]}],l=_e();return ue.jsxs(ue.Fragment,{children:[ue.jsx(ts,{title:"owner of"}),ue.jsx(f,{items:a.map(({label:e,description:s,data:t},o)=>({key:o,label:ue.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[ue.jsx("div",{children:ue.jsx(ns,{children:e})}),ue.jsxs("div",{children:[ue.jsx(ns,{type:"secondary",style:{fontSize:12},children:s})," ",ue.jsx(ns,{children:t.length})]})]}),children:"Meta"===e?t.map((e,s)=>ue.jsxs(n.Fragment,{children:[ue.jsx(l,{pid:e}),s===t.length-1?"":", "]},e)):t.join(", ")}))})]})},{Text:as}=o,ls=({processData:e})=>{const{MonitorsPID:s,MonitorsProcessID:t,MonitorsAlias:o,MonitorsEvent:a,MonitorsNode:l}=e?.Message.Info??{},i=[{label:"PID",description:"created using gen.Process.MonitorPID(...)",data:s??[]},{label:"Process ID",description:"created using gen.Process.MonitorProcessID(...)",data:t??[]},{label:"Alias",description:"created using gen.Process.MonitorAlias(...)",data:o??[]},{label:"Event",description:"created using gen.Process.MonitorEvent(...)",data:a??[]},{label:"Node",description:"created using gen.Process.MonitorNode(...)",data:l??[]}],r=_e();return ue.jsxs(ue.Fragment,{children:[ue.jsx(ts,{title:"monitors"}),ue.jsx(f,{items:i.map(({label:e,description:s,data:t},o)=>({key:o,label:ue.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[ue.jsx("div",{children:ue.jsx(as,{children:e})}),ue.jsxs("div",{children:[ue.jsx(as,{type:"secondary",style:{fontSize:12},children:s})," ",ue.jsx(as,{children:t.length})]})]}),children:"PID"===e?t.map((e,s)=>ue.jsxs(n.Fragment,{children:[ue.jsx(r,{pid:e}),s===t.length-1?"":", "]},e)):t.join(", ")}))})]})},{Text:is}=o,rs=({processData:e})=>{const{LinksPID:s,LinksProcessID:t,LinksAlias:o,LinksEvent:a,LinksNode:l}=e?.Message.Info??{},i=[{label:"PID",description:"created using gen.Process.LinkPID(...)",data:s??[]},{label:"Process ID",description:"created using gen.Process.LinkProcessID(...)",data:t??[]},{label:"Alias",description:"created using gen.Process.LinkAlias(...)",data:o??[]},{label:"Event",description:"created using gen.Process.LinkEvent(...)",data:a??[]},{label:"Node",description:"created using gen.Process.MonitorNode(...)",data:l??[]}],r=_e();return ue.jsxs(ue.Fragment,{children:[ue.jsx(ts,{title:"links"}),ue.jsx(f,{items:i.map(({label:e,description:s,data:t},o)=>({key:o,label:ue.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[ue.jsx("div",{children:ue.jsx(is,{children:e})}),ue.jsxs("div",{children:[ue.jsx(is,{type:"secondary",style:{fontSize:12},children:s})," ",ue.jsx(is,{children:t.length})]})]}),children:"PID"===e?t.map((e,s)=>ue.jsxs(n.Fragment,{children:[ue.jsx(r,{pid:e}),s===t.length-1?"":", "]},e)):t.join(", ")}))})]})},{Text:cs}=o,ds=[{title:"Name",dataIndex:"name",key:"name",render:e=>ue.jsx(cs,{type:"secondary",children:e})},{title:"Value",dataIndex:"value",key:"value"}],ms=({dataSource:e})=>ue.jsx(b,{dataSource:e,columns:ds,showHeader:!1,pagination:!1}),{Text:us}=o,hs={debug:"rgb(16, 168, 3)",info:"rgb(9, 131, 179)",warning:"rgb(161, 27, 236)",error:"#ff0f0f",panic:"#ffffff"},ps=e=>"panic"===e?"#ff0f0f":void 0,gs=e=>Boolean(e.Message.PID),xs=e=>Boolean(e.Message.Meta)&&Boolean(e.Message.Parent),fs=({item:e})=>{const{crc:s}=$();return(e=>Boolean(e.Message.Creation))(e)?ue.jsxs("span",{children:[ue.jsx(us,{style:{color:hs[e.Message.Level],backgroundColor:ps(e.Message.Level),fontSize:"12px"},children:ss(e.Timestamp)})," ",e.Message.Name," ",e.Message.Message]}):gs(e)?ue.jsxs("span",{children:[ue.jsx(us,{style:{color:hs[e.Message.Level],backgroundColor:ps(e.Message.Level),fontSize:"12px"},children:ss(e.Timestamp)})," ",ue.jsx(j,{children:ue.jsx(F,{to:`/${s}/process/${e.Message.PID}/info`,children:e.Message.PID})}),e.Message.Message]}):xs(e)?ue.jsxs("span",{children:[ue.jsx(us,{style:{color:hs[e.Message.Level],backgroundColor:ps(e.Message.Level),fontSize:"12px"},children:ss(e.Timestamp)})," ",ue.jsx(j,{children:ue.jsx(F,{to:`/${s}/meta_process/${e.Message.Meta.replace("#","%23")}/info`,children:e.Message.Meta})}),e.Message.Message]}):(e=>Boolean(e.Message.Peer))(e)?ue.jsxs("span",{children:[ue.jsx(us,{style:{color:hs[e.Message.Level],backgroundColor:ps(e.Message.Level),fontSize:"12px"},children:ss(e.Timestamp)})," ",ue.jsx(j,{children:e.Message.Peer}),e.Message.Message]}):ue.jsxs("span",{children:[ue.jsxs(us,{style:{color:hs[e.Message.Level],backgroundColor:ps(e.Message.Level),fontSize:"12px"},children:[ss(e.Timestamp),":"]})," ",e.Message.Message]})},{Text:ys}=o,bs=[{label:"debug",value:"debug"},{label:"info",value:"info"},{label:"warning",value:"warning"},{label:"error",value:"error"},{label:"panic",value:"panic"}].map(({value:e})=>({label:ue.jsx(ys,{style:{color:hs[e],backgroundColor:ps(e)},children:e}),value:e})),js=Z(({logs:e,page:s})=>{const{logsStore:t}=zs(),[o,a]=n.useState(t.logLevels);return n.useEffect(()=>{t.tryToSubscribeLogData()},[o]),ue.jsxs("div",{children:[ue.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[ue.jsx("div",{children:ue.jsx(v.Group,{options:bs,defaultValue:o,onChange:e=>{a(e),t.setLogLevels(e)}})}),ue.jsxs("div",{children:[ue.jsx(ys,{style:{color:"#a0a0a0"},children:"Last: "}),ue.jsx(x,{min:1,variant:"borderless",value:"common"===s?t.lastCount:"process"===s?t.processLastCount:"meta"===s?t.metaProcessLastCount:void 0,onChange:e=>{"common"===s&&t.setLastCount(e??1),"process"===s&&t.setProcessLastCount(e??1),"meta"===s&&t.setMetaProcessLastCount(e??1)},controls:!1,style:{padding:0,margin:0,width:"45px"}}),ue.jsx(ys,{style:{color:"#a0a0a0"},children:"messages "}),ue.jsx(k,{icon:t.pauseLogs?ue.jsx(M,{}):ue.jsx(S,{}),type:"primary",style:{marginLeft:"20px"},onClick:()=>{const e=!t.pauseLogs;t.setPauseLogs(e),e?t.unsubscribeLogData():t.tryToSubscribeLogData()}})]})]}),ue.jsx("div",{style:{height:"calc(100vh - 40px - 32px - 40px)",overflow:"scroll"},children:ue.jsx(C,{size:"small",dataSource:[...e].reverse(),renderItem:e=>ue.jsx(C.Item,{children:ue.jsx(fs,{item:e})},e.Timestamp)})})]})}),vs=Z(()=>{const{logsStore:e}=zs(),s=Y(e.logsToRender);return ue.jsx(js,{logs:s,page:"common"})}),ks=Z(()=>{const{logsStore:e}=zs(),s=Y(e.processLogsToRender);return ue.jsx("div",{style:{minHeight:"calc(100vh - 40px - 45px - 80px"},children:ue.jsx("div",{style:{padding:"15px 30px"},children:ue.jsx(js,{logs:s,page:"process"})})})}),Ms=61,Ss=e=>"string"==typeof e||"number"==typeof e?e:"boolean"==typeof e?Ae(e):JSON.stringify(e),Cs=Z(()=>{const{pid:e}=$(),{websocketStore:s,logsStore:t}=zs(),{commonContext:{nodeName:o}}=xe(),[a,l]=n.useState(),[i,r]=n.useState(),[c,d]=n.useState(""),[m,u]=n.useState(""),h=B("/:crc/process/:pid/*"),p=[h?.params["*"]];n.useEffect(()=>{if(o)return s.sendMessage(`{\n        "CID": "${P()}",\n        "Command": "subscribe",\n        "Name": "process",\n        "Args":\n          {"PID":"${e}"}\n    }`),()=>{s.sendMessage(`\n      {\n        "CID": "${P()}",\n        "Command": "unsubscribe",\n        "Name": "${c}"\n    }`)}},[o,c,e]),n.useEffect(()=>{if(o)return"inspect"===p[0]&&s.sendMessage(`{\n        "CID": "${P()}",\n        "Command": "subscribe",\n        "Name": "process_state",\n        "Args":\n          {"PID":"${e}"}\n    }`),()=>{m&&(s.sendMessage(`\n      {\n        "CID": "${P()}",\n        "Command": "unsubscribe",\n        "Name": "${m}"\n    }`),u(""))}},[o,s,c,m,e,p[0]]);const x=n.useRef(Array(Ms).fill({xValue:0,messagesIn:0,messagesInTotal:0,messagesOut:0,messagesOutTotal:0,queueMain:0,queueSystem:0,queueUrgent:0,queueLog:0,timeStamp:0}).map((e,s)=>({...e,xValue:60-s})));n.useEffect(()=>{x.current=Array(Ms).fill({xValue:0,messagesIn:0,messagesInTotal:0,messagesOut:0,messagesOutTotal:0,queueMain:0,queueSystem:0,queueUrgent:0,queueLog:0,timeStamp:0}).map((e,s)=>({...e,xValue:60-s}))},[e]);const y=s=>{var t;if(ve(t=s)&&ke(t)&&void 0!==t.Result&&"object"==typeof t.Result&&"string"==typeof(t?.Result).Event&&t.Result.Event.includes("inspect_process")&&e&&s.Result.Event.includes(e)&&d(s.Result.Event),!Ce(s)&&(e=>ve(e)&&ke(e)&&"string"==typeof e?.Event&&e.Event.includes("inspect_process")&&!e.Event.includes("inspect_process_list")&&!e.Event.includes("inspect_process_state"))(s)&&e&&s.Event.includes(e)&&!s.Message.Terminated){l(s);const e=x.current.length-1;if(0===x.current[e].messagesInTotal)x.current[e].messagesIn=0,x.current[e].messagesInTotal=s.Message.Info.MessagesIn,x.current[e].messagesOut=0,x.current[e].messagesOutTotal=s.Message.Info.MessagesOut,x.current[e].queueMain=s.Message.Info.MailboxQueues.Main,x.current[e].queueSystem=s.Message.Info.MailboxQueues.System,x.current[e].queueUrgent=s.Message.Info.MailboxQueues.Urgent,x.current[e].queueLog=s.Message.Info.MailboxQueues.Log,x.current[e].timeStamp=s.Timestamp;else{const e=x.current.at(-1);if(e){const t=Math.floor((es(s.Timestamp)-es(e.timeStamp))/1e3),n=s.Message.Info.MessagesIn-e.messagesInTotal,o=s.Message.Info.MessagesOut-e.messagesOutTotal;x.current.splice(0,t);for(let e=1;e<=t;e++)e===t?x.current.push({xValue:0,messagesIn:n,messagesInTotal:s.Message.Info.MessagesIn,messagesOut:o,messagesOutTotal:s.Message.Info.MessagesOut,queueMain:s.Message.Info.MailboxQueues.Main,queueSystem:s.Message.Info.MailboxQueues.System,queueUrgent:s.Message.Info.MailboxQueues.Urgent,queueLog:s.Message.Info.MailboxQueues.Log,timeStamp:s.Timestamp}):x.current.push({timeStamp:0,xValue:0});x.current=x.current.map((e,s)=>({...e,xValue:60-s}))}}}(e=>ve(e)&&ke(e)&&void 0!==e.Result&&"object"==typeof e.Result&&"string"==typeof(e?.Result).Event&&e.Result.Event.includes("inspect_process_state"))(s)&&u(s.Result.Event),!Ce(s)&&(e=>ve(e)&&ke(e)&&"string"==typeof e?.Event&&e.Event.includes("inspect_process_state"))(s)&&r(s),Ce(s)&&l(e=>e?{...e,Message:{...e.Message,Info:{...e.Message.Info,State:"terminated"}}}:void 0)};return n.useEffect(()=>(s.addCallback({type:`initProcessPage_${e}`,fn:y}),()=>s.removeCallback({type:`initProcessPage_${e}`})),[e]),n.useLayoutEffect(()=>{t.clearProcessLogs(),t.setProcessFilter(s=>!!e&&gs(s)&&s.Message.PID.includes(e))},[]),ue.jsxs(ue.Fragment,{children:[ue.jsx($e,{processData:a}),"info"===p[0]&&ue.jsxs("div",{style:{padding:"5px 25px"},children:[ue.jsx(We,{processData:a}),ue.jsx(ts,{title:"messages"}),ue.jsx(Ze,{chartBuffer:x.current}),ue.jsxs(ye,{children:[ue.jsx(be,{children:ue.jsx(g,{colon:!0,size:"small",items:[{key:"0",label:"Total In",children:a?.Message.Info.MessagesIn}],column:1,layout:"horizontal"})}),ue.jsx(be,{children:ue.jsx(g,{colon:!0,size:"small",items:[{key:"0",label:"Total Out",children:a?.Message.Info.MessagesOut}],column:1,layout:"horizontal"})})]}),ue.jsx(ts,{title:"mailbox queues"}),ue.jsx(Ye,{chartBuffer:x.current}),ue.jsx(os,{processData:a}),ue.jsx(ls,{processData:a}),ue.jsx(rs,{processData:a}),ue.jsx(ts,{title:"environment variables"}),ue.jsx(ms,{dataSource:Object.entries(a?.Message.Info.Env??{}).map(([e,s])=>({key:e,name:e,value:Ss(s)}))})]}),"inspect"===p[0]&&ue.jsx("div",{style:{minHeight:"calc(100vh - 40px - 45px - 80px",padding:"5px 25px"},children:i?.Message.State?ue.jsx(f,{items:Object.entries(i?.Message.State??{}).map(([e,s])=>({key:e,label:e,children:s}))}):ue.jsx(I,{image:I.PRESENTED_IMAGE_SIMPLE})}),"log"===p[0]&&ue.jsx(ks,{})]})}),Is=()=>Array(Ms).fill({xValue:0,memoryUsed:0,memoryAlloc:0,timeStamp:0}).map((e,s)=>({...e,xValue:s})).reverse(),Rs=()=>Array(Ms).fill({xValue:0,processesTotal:0,processesRunning:0,timeStamp:0}).map((e,s)=>({...e,xValue:s})).reverse();class ws{nodeData;memoryBufferRef=Is();processesBufferRef=Rs();parentStore=null;nodeDataToRender;memoryBufferRefToRender=Is();processesBufferRefToRender=Rs();constructor(e){G(this,{nodeData:!1,memoryBufferRef:!1,processesBufferRef:!1}),this.parentStore=e,this.startCollectNodeData(),this.syncData()}syncData(){setInterval(()=>{J(()=>{this.nodeDataToRender=this.nodeData,this.memoryBufferRefToRender=this.memoryBufferRef,this.processesBufferRefToRender=this.processesBufferRef})},1e3)}setNodeData(e){this.nodeData=e}clearCharts(){this.memoryBufferRef=Is(),this.memoryBufferRefToRender=Is(),this.processesBufferRef=Rs(),this.processesBufferRefToRender=Rs()}startCollectNodeData(){this.parentStore?.addCallback({type:"startCollectNodeData",fn:e=>{if(Me(e)){this.setNodeData(e);const s=this.memoryBufferRef.length-1;if(0===this.memoryBufferRef[s].memoryUsed)this.memoryBufferRef[s].memoryUsed=e.Message.Info.MemoryUsed,this.memoryBufferRef[s].memoryAlloc=e.Message.Info.MemoryAlloc,this.memoryBufferRef[s].timeStamp=e.Timestamp;else{if(this.memoryBufferRef.length>61)return void(this.memoryBufferRef=Is());const s=this.memoryBufferRef.at(-1);if(s){const t=Math.floor((es(e.Timestamp)-es(s.timeStamp))/1e3);this.memoryBufferRef.splice(0,t);for(let s=1;s<=t;s++)s===t?this.memoryBufferRef.push({xValue:0,memoryUsed:e.Message.Info.MemoryUsed,memoryAlloc:e.Message.Info.MemoryAlloc,timeStamp:e.Timestamp}):this.memoryBufferRef.push({timeStamp:0,xValue:0,memoryUsed:0,memoryAlloc:0});this.memoryBufferRef=this.memoryBufferRef.map((e,s)=>({...e,xValue:60-s}))}}const t=this.processesBufferRef.length-1;if(0===this.processesBufferRef[t].processesTotal)this.processesBufferRef[t].processesTotal=e.Message.Info.ProcessesTotal,this.processesBufferRef[t].processesRunning=e.Message.Info.ProcessesRunning,this.processesBufferRef[t].timeStamp=e.Timestamp;else{if(this.processesBufferRef.length>61)return void(this.processesBufferRef=Rs());const s=this.processesBufferRef.at(-1);if(s){const t=Math.floor((es(e.Timestamp)-es(s.timeStamp))/1e3);this.processesBufferRef.splice(0,t);for(let s=1;s<=t;s++)s===t?this.processesBufferRef.push({xValue:0,processesTotal:e.Message.Info.ProcessesTotal,processesRunning:e.Message.Info.ProcessesRunning,timeStamp:e.Timestamp}):this.processesBufferRef.push({timeStamp:0,xValue:0,processesRunning:0,processesTotal:0});this.processesBufferRef=this.processesBufferRef.map((e,s)=>({...e,xValue:60-s}))}}}}})}}class Ns{networkData;networkDataToRender;websocketStore;nodeStore;resultEvent;constructor(e,s){G(this,{networkData:!1}),this.websocketStore=e,this.nodeStore=s,this.startCollectNetworkData(),this.syncData()}syncData(){setInterval(()=>{J(()=>{this.networkDataToRender=this.networkData})},1e3)}setNetworkData(e){this.networkData=e}setResultEvent(e){this.resultEvent=e}unsubscribeNetworkData(){this.resultEvent&&(this.websocketStore?.sendMessage(`{\n        "CID": "${P()}",\n        "Command": "unsubscribe",\n        "Name": "${this.resultEvent}"\n      }`),this.setResultEvent(void 0))}tryToSubscribeNetworkData(){if(this.nodeStore?.nodeData?.Message.Info.Name)this.resultEvent&&this.websocketStore?.sendMessage(`{\n          "CID": "${P()}",\n          "Command": "unsubscribe",\n          "Name": "${this.resultEvent}"\n        }`),this.websocketStore?.sendMessage(`{\n        "CID": "${P()}",\n        "Command": "subscribe",\n        "Name": "network"\n      }`);else{const e=setTimeout(()=>{this.tryToSubscribeNetworkData(),clearTimeout(e)},200)}}startCollectNetworkData(){this.websocketStore?.addCallback({type:"startCollectNetworkData",fn:e=>{var s;ve(s=e)&&ke(s)&&"string"==typeof s?.Event&&s.Event.includes("inspect_network")&&this.setNetworkData(e),(e=>ve(e)&&ke(e)&&void 0!==e.Result&&"object"==typeof e.Result&&"string"==typeof(e?.Result).Event&&e.Result.Event.includes("inspect_network"))(e)&&this.setResultEvent(e.Result.Event)}})}}class Ds{processListData;processListDataToRender;resultEvent;websocketStore;nodeStore;sort="pid";limit=100;startFrom=1001;constructor(e,s){G(this,{processListData:!1}),this.websocketStore=e,this.nodeStore=s,this.startCollectProcessListData(),this.syncData()}syncData(){setInterval(()=>{J(()=>{this.processListDataToRender=this.processListData})},1e3)}setResultEvent(e){this.resultEvent=e}setProcessListData(e){this.processListData=e}setSort(e){this.sort=e}unsubscribeProcessData(){this.resultEvent&&(this.websocketStore?.sendMessage(`{\n        "CID": "${P()}",\n        "Command": "unsubscribe",\n        "Name": "${this.resultEvent}"\n      }`),this.setResultEvent(void 0))}tryToSubscribeProcessListData(){if(this.nodeStore?.nodeData?.Message.Info.Name)this.resultEvent&&this.websocketStore?.sendMessage(`\n      {\n        "CID": "${P()}",\n        "Command": "unsubscribe",\n        "Name": "${this.resultEvent}"\n    }`),this.websocketStore?.sendMessage(`{\n        "CID": "${P()}",\n        "Command": "subscribe",\n        "Name": "process_list",\n        "Args":\n          {"start":${this.startFrom}, "limit":${this.limit}}\n    }`);else{const e=setTimeout(()=>{this.tryToSubscribeProcessListData(),clearTimeout(e)},200)}}setLimit(e){this.limit=e}setStartFrom(e){this.startFrom=e}startCollectProcessListData(){this.websocketStore?.addCallback({type:"startCollectProcessListData",fn:e=>{var s;ve(s=e)&&ke(s)&&void 0!==s.Result&&"object"==typeof s.Result&&"string"==typeof(s?.Result).Event&&s.Result.Event.includes("inspect_process_list")&&this.setResultEvent(e.Result.Event),(e=>ve(e)&&ke(e)&&"string"==typeof e?.Event&&e.Event.includes("inspect_process_list"))(e)&&this.setProcessListData(e)}})}}class Ts{nodeData;lastResult;websocketStore;nodeStore;constructor(e){G(this),this.websocketStore=e}setNodeData(e){this.nodeData=e}setLastResult(e){this.lastResult=e}clearNodeData(){this.nodeData=void 0,this.lastResult=void 0,this.lastResult=void 0}}const Es=()=>Array(Ms).fill({xValue:0,messagesIn:0,messagesInTotal:0,messagesOut:0,messagesOutTotal:0,timeStamp:0}).map((e,s)=>({...e,xValue:60-s})),Ls=()=>Array(Ms).fill({xValue:0,bytesIn:0,bytesInTotal:0,bytesOut:0,bytesOutTotal:0,timeStamp:0}).map((e,s)=>({...e,xValue:60-s}));class Ps{websocketStore;networkStore;nodesToSubscribe=[];connectedNodes;nodeMap={};constructor(e,s){G(this),this.websocketStore=e,this.networkStore=s}clearStoreData(){this.nodesToSubscribe=[],this.connectedNodes=void 0,this.nodeMap={}}clearNodesToSubscribe(){this.nodesToSubscribe=[]}updateNodesInfo(){const e=this.networkStore?.networkData?.Message.Info.Nodes??[],s=this.nodesToSubscribe.filter(s=>!e.includes(s));for(const n of s)this.nodesToSubscribe=this.nodesToSubscribe.filter(e=>e!==n),delete this.nodeMap[n];const t=e.filter(e=>!this.nodesToSubscribe.includes(e));for(const n of t)this.addNodeToSubscribe(n)}unsubscribeConnectedNodes(){Object.entries(this.nodeMap).forEach(([e,s])=>{s?.resultMessage&&(this.websocketStore?.sendMessage(`{\n        "CID": "${P()}",\n        "Command": "unsubscribe",\n        "Name": "${s.resultMessage}"\n      }`),this.websocketStore?.removeCallback({type:`initConnectedNode_${e}`}))})}resubscribeConnectedNodes(){Object.entries(this.nodeMap).forEach(([e,s])=>{s?.subsribed&&(this.websocketStore?.removeCallback({type:`initConnectedNode_${e}`}),this.addNodeToSubscribe(e))})}trySetNodes(){if(this.connectedNodes)return;const e=this.networkStore?.networkData?.Message.Info.Nodes;if(e)this.connectedNodes=e,e.forEach(e=>{this.nodeMap[e]={subsribed:this.nodeMap[e]?.subsribed??!1,messagesBufferRef:this.nodeMap[e]?.messagesBufferRef??Es(),bytesBufferRef:this.nodeMap[e]?.bytesBufferRef??Ls()}});else{const e=setTimeout(()=>{this.trySetNodes(),clearTimeout(e)},200)}}addNodeToSubscribe(e){if(this.nodesToSubscribe.includes(e))return;this.nodesToSubscribe.push(e),this.websocketStore?.sendMessage(`{\n      "CID": "${P()}",\n      "Command": "subscribe",\n      "Name": "remote_node",\n      "Args": \n          {"Name": "${e}"}\n  }`);this.websocketStore?.addCallback({type:`initConnectedNode_${e}`,fn:s=>{var t;if(ve(t=s)&&ke(t)&&void 0!==t.Result&&"object"==typeof t.Result&&"string"==typeof(t?.Result).Event&&t.Result.Event.includes("inspect_connection")&&e&&s.Result.Event.includes(e)&&(this.nodeMap[e]={subsribed:!0,resultMessage:s.Result.Event,bytesBufferRef:this.nodeMap[e]?.bytesBufferRef??Ls(),messagesBufferRef:this.nodeMap[e]?.messagesBufferRef??Es()}),(e=>ve(e)&&ke(e)&&"string"==typeof e?.Event&&e.Event.includes("inspect_connection"))(s)&&e&&!Ce(s)&&s.Event.includes(e)){this.nodeMap[e].data=s;const t=this.nodeMap[e]?.messagesBufferRef??Es(),n=t.length-1;if(0===t[n].messagesInTotal)t[n].messagesIn=0,t[n].messagesInTotal=s.Message.Info.MessagesIn,t[n].messagesOut=0,t[n].messagesOutTotal=s.Message.Info.MessagesOut,t[n].timeStamp=s.Timestamp;else{if(this.nodeMap[e].messagesBufferRef.length>61)return void(this.nodeMap[e].messagesBufferRef=Es());const n=t.at(-1);if(n){const o=Math.floor((es(s.Timestamp)-es(n.timeStamp))/1e3),a=s.Message.Info.MessagesIn-n.messagesInTotal,l=s.Message.Info.MessagesOut-n.messagesOutTotal;t.splice(0,o);for(let e=1;e<=o;e++)e===o?t.push({xValue:0,timeStamp:s.Timestamp,messagesIn:a<0?0:a,messagesInTotal:s.Message.Info.MessagesIn,messagesOut:l<0?0:l,messagesOutTotal:s.Message.Info.MessagesOut}):t.push({timeStamp:0,xValue:0,messagesIn:0,messagesInTotal:0,messagesOut:0,messagesOutTotal:0});this.nodeMap[e].messagesBufferRef=t.map((e,s)=>({...e,xValue:60-s}))}}const o=this.nodeMap[e]?.bytesBufferRef??Ls(),a=o.length-1;if(0===o[a].bytesInTotal)o[a].bytesIn=0,o[a].bytesInTotal=s.Message.Info.BytesIn,o[a].bytesOut=0,o[a].bytesOutTotal=s.Message.Info.BytesOut,o[a].timeStamp=s.Timestamp;else{if(this.nodeMap[e].bytesBufferRef.length>61)return void(this.nodeMap[e].bytesBufferRef=Ls());const t=o.at(-1);if(t){const n=Math.floor((es(s.Timestamp)-es(t.timeStamp))/1e3),a=s.Message.Info.BytesIn-t.bytesInTotal,l=s.Message.Info.BytesOut-t.bytesOutTotal;o.splice(0,n);for(let e=1;e<=n;e++)e===n?o.push({xValue:0,bytesIn:a<0?0:a,bytesInTotal:s.Message.Info.BytesIn,bytesOut:l<0?0:l,bytesOutTotal:s.Message.Info.BytesOut,timeStamp:s.Timestamp}):o.push({timeStamp:0,xValue:0,bytesIn:0,bytesInTotal:0,bytesOut:0,bytesOutTotal:0});this.nodeMap[e].bytesBufferRef=o.map((e,s)=>({...e,xValue:60-s}))}}}}})}}class $s{applicationListData;resultEvent;websocketStore;nodeStore;constructor(e,s){G(this),this.websocketStore=e,this.nodeStore=s,this.startCollectApplicationListData()}setResultEvent(e){this.resultEvent=e}setApplicationListData(e){this.applicationListData=e}unsubscribeApplicationData(){this.resultEvent&&(this.websocketStore?.sendMessage(`{\n        "CID": "${P()}",\n        "Command": "unsubscribe",\n        "Name": "${this.resultEvent}"\n      }`),this.setResultEvent(void 0))}tryToSubscribeApplicationListData(){if(!this.nodeStore?.nodeData?.Message.Info.Name)return void setTimeout(()=>this.tryToSubscribeApplicationListData(),200);this.resultEvent&&this.unsubscribeApplicationData();const e=`{\n      "CID": "${P()}",\n      "Command": "subscribe",\n      "Name": "application_list"\n    }`;this.websocketStore?.sendMessage(e)}startCollectApplicationListData(){this.websocketStore?.addCallback({type:"applications-store-callback",fn:e=>{var s;ve(s=e)&&ke(s)&&void 0!==s.Result&&"object"==typeof s.Result&&"string"==typeof(s?.Result).Event&&s.Result.Event.includes("inspect_application_list")&&J(()=>{this.resultEvent=e.Result.Event}),(e=>ve(e)&&ke(e)&&"string"==typeof e?.Event&&e.Event.includes("inspect_application_list"))(e)&&J(()=>{this.applicationListData=e})}})}}const As=n.createContext(null),zs=()=>{const e=n.useContext(As);if(!e)throw new Error("useMobxWebSocketContext must be used within MobxWebsocketContextProvider");return e},Bs=(()=>{let e=null;return()=>{if(!e){const s=new je,t=new ws(s),n=new Re(s,t),o=new Ns(s,t),a=new Ps(s,o),l=new Ds(s,t),i=new Ts(s),r=new $s(s,t);e={websocketStore:s,nodeStore:t,logsStore:n,networkStore:o,networkConnectedNodesStore:a,processesStore:l,connectedNodeStore:i,applicationsStore:r}}return e}})(),Fs=Z(({children:e})=>{const{commonContext:{nodeName:s},setCommonContext:t}=xe(),o=n.useMemo(()=>Bs(),[]),{websocketStore:a,logsStore:l,connectedNodeStore:i}=o,r=n.useRef(s);n.useEffect(()=>{r.current=s},[s]);const c=n.useCallback(e=>{var s;Se(e)&&(l.clearAllLogs(),t(s=>({...s,os:e.Result.OS,architecture:e.Result.Arch,cpuCores:e.Result.Cores,CRC32:e.Result.CRC32})),i.setLastResult(e)),ve(s=e)&&void 0!==s.Node&&void 0!==s.Node.Name&&"string"==typeof s.Node.Name&&(t(s=>({...s,release:e.Version.Release,commit:e.Version.Commit,productName:e.Version.Name})),i.setNodeData(e)),Me(e)&&(r.current&&e.Message.Info.Name===r.current||t(s=>({...s,nodeName:e.Message.Info.Name})))},[l,t,i]);n.useEffect(()=>{a.addCallback({type:"initialCallback",fn:c})},[a,c]);const d=n.useRef(!1);n.useEffect(()=>{d.current||(a.startSocket(),d.current=!0)},[a]);const m=a.connected;return n.useEffect(()=>{m&&a.readSocket()},[m,a]),ue.jsx(As.Provider,{value:o,children:e})});Fs.displayName="MobxWebsocketContextProvider";const{Text:Os}=o,_s=e=>/\S+@\S+/.test(e),Vs=()=>{const{connectedNodeStore:e}=zs();return[Y(e.nodeData?.Node),...Y(e.nodeData?.Peers)??[]].filter(e=>Boolean(e?.Name))},Us=Z(()=>{const{websocketStore:e,connectedNodeStore:s}=zs(),t=xe(),{commonContext:{CRC32:o}}=t,[c,d]=n.useState(""),[m,u]=n.useState(""),[h,p]=n.useState({Cookie:void 0,Host:void 0,Port:void 0,TLS:void 0}),g=Y(s.nodeData?.Node),[x,y]=n.useState([]),b=[g,...x].filter(e=>Boolean(e?.Name)),j=z(),v=A(),k=j.pathname.includes("/process")&&!j.pathname.includes("/processes"),M=j.pathname.includes("/meta_process"),S=j.pathname.split("/").filter((e,s)=>s>1).join("/")||"info",[C,I]=n.useState(),D=()=>{const s=P();e.addCallback({type:`changeConnection_${s}`,fn:t=>{if(!Ie(t)||t.CID!==s)return Se(t)&&t.CID===s?(I(void 0),e.removeCallback({type:`changeConnection_${s}`}),p({}),v(k||M?`/${t.Result.CRC32}/info`:`/${t.Result.CRC32}/${S}`),void d("")):void 0;I(t.Error)}}),e.sendMessage(`{\n        "CID": "${s}",\n        "Command": "connect",\n        "Name": "${m}",\n        "Args": ${JSON.stringify(h)}\n      }`)};return ue.jsxs(ue.Fragment,{children:[ue.jsx(l,{menu:{items:[...b.filter(e=>e.CRC32!==o).map(e=>({key:e.CRC32,label:`${e.Name} (${e.CRC32})`})),{key:"connect",label:"Connect ..."}],selectedKeys:[],onSelect:e=>{d(e.key)},selectable:!0},trigger:["click"],children:ue.jsx(i,{style:{color:"#ffffff",paddingLeft:"10px"},onClick:()=>{const s=P();e.addCallback({type:"getPeers",fn:t=>{if(ve(n=t)&&Array.isArray(n.Result)&&t.CID===s)return y(t.Result),void e.removeCallback({type:"getPeers"});var n}}),e.sendMessage(`{\n              "CID": "${s}",\n              "Command": "peers"\n            }`)}})}),ue.jsxs(r,{width:400,title:ue.jsx(Os,{type:"secondary",style:{fontSize:16},children:"Switch connection"}),open:"connect"!==c&&""!==c,onOk:()=>{const s=b.find(e=>e.CRC32===c);if(!s)return;const t=P();e.addCallback({type:`changeConnection_${t}`,fn:s=>{if(!Ie(s)||s.CID!==t)return Se(s)&&s.CID===t?(I(void 0),e.removeCallback({type:`changeConnection_${t}`}),v(k||M?`/${c}/info`:`/${c}/${S}`),void d("")):void 0;I(s.Error)}}),e.sendMessage(`{\n            "CID": "${t}",\n            "Command": "connect",\n            "Name": "${s.Name}"\n          }`)},okText:"Switch",onCancel:()=>{d("")},destroyOnClose:!0,closable:!0,children:[C&&ue.jsx("div",{style:{paddingBottom:"15px"},children:ue.jsx(R,{message:C,type:"error",closable:!0,onClose:()=>I(void 0)})}),ue.jsx(Os,{type:"secondary",children:"Node:"})," ",ue.jsx(Os,{children:b.find(e=>e.CRC32===c)?.Name})]}),ue.jsxs(r,{width:400,title:ue.jsx(Os,{type:"secondary",style:{fontSize:16},children:"Connect..."}),okButtonProps:{disabled:!_s(m)},open:"connect"===c,onOk:D,okText:"Connect",onCancel:()=>{d(""),p({}),I(void 0)},destroyOnClose:!0,closable:!0,children:[C&&ue.jsx("div",{style:{paddingBottom:"15px"},children:ue.jsx(R,{message:C,type:"error",closable:!0,onClose:()=>I(void 0)})}),ue.jsxs(w,{size:"small",name:"basic",labelCol:{span:8},wrapperCol:{span:16},autoComplete:"off",children:[ue.jsx(w.Item,{label:"Remote Node",name:"remoteNode",rules:[{required:!0,message:"Please input remote node name"},({getFieldValue:e})=>({validator:(s,t)=>!t||_s(e("remoteNode"))?Promise.resolve():Promise.reject(new Error("incorrect nodename"))})],children:ue.jsx(a,{value:m,onChange:e=>u(e.target.value),onKeyDown:e=>{"Enter"===e.key&&_s(m)&&D()}})}),ue.jsx(f,{items:[{key:"1",label:"options",children:ue.jsxs(ue.Fragment,{children:[ue.jsx(w.Item,{label:"Cookie",name:"cookie",children:ue.jsx(a.Password,{value:h.Cookie,onChange:e=>{const s=e.target.value;p(e=>({...e,Cookie:""===s?void 0:s}))}})}),ue.jsx(w.Item,{label:"Host",name:"host",children:ue.jsx(a,{value:h.Host,onChange:e=>{const s=e.target.value;p(e=>({...e,Host:""===s?void 0:s}))}})}),ue.jsx(w.Item,{label:"Port",name:"port",children:ue.jsx(a,{type:"number",value:h.Port,onChange:e=>{const s=e.target.value;p(e=>({...e,Port:""===s?void 0:Number(s)}))}})}),ue.jsx(w.Item,{label:"Enable TLS",valuePropName:"checked",children:ue.jsx(N,{onChange:e=>p(s=>({...s,TLS:e}))})})]})}]})]})]})]})}),{Text:Ks}=o,qs=()=>ue.jsx("img",{src:"/assets/observer.logo-v8Jq3JQk.svg"}),Hs=Z(()=>{const e=xe(),{commonContext:{nodeName:s,CRC32:t}}=e,{connectedNodeStore:n}=zs(),o=Y(n.nodeData?.Node.Name)??"",a=s&&s!==o;return ue.jsx("header",{style:{position:"fixed",top:0,zIndex:100,height:"70px"},children:ue.jsx("div",{style:{display:"flex",justifyContent:"center",width:"100vw"},children:ue.jsx("div",{style:{width:"850px",backgroundColor:"#1f242b",borderBottomLeftRadius:"3px",borderBottomRightRadius:"3px",boxShadow:"0px 5px 10px -5px #373737"},children:ue.jsx("div",{style:{padding:"10px 10px"},children:ue.jsxs(ye,{children:[ue.jsx(F,{to:t?`/${t}/info`:"/",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:ue.jsx(qs,{})}),ue.jsxs("div",{style:{display:"flex",height:"50px"},children:[ue.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"end",justifyContent:"center"},children:[ue.jsxs(Ks,{style:{color:"white",padding:"0 0 0 0",margin:"0 0 0 0",fontSize:"18px"},children:[s," ",t&&`(${t})`]}),a&&ue.jsx(Ks,{style:{color:"#50b669",padding:"0 0 0 0",margin:"0 0 0 0",fontSize:12,position:"absolute",top:"45px"},children:"remote"})]}),ue.jsx(Us,{})]})]})})})})})}),Ws=({nodeName:e,version:s,ergoFramework:t,os:n,architecture:o,cpuCores:a,uptime:l,logLevel:i})=>ue.jsx(g,{size:"small",items:[{key:"nodeName",label:"Node Name",children:e},{key:"version",label:"Version",children:s},{key:"2",label:"Ergo Framework",children:t},{key:"3",label:"OS",children:n},{key:"4",label:"Architecture",children:o},{key:"5",label:"CPU Cores",children:a},{key:"7",label:"Uptime",children:l&&ue.jsx(Ve,{uptime:l})},{key:"8",label:"Log Level",children:""!==i&&ue.jsx(Be,{logLevel:i})}],column:1}),Qs=({applicationsTotal:e,applicationsRunning:s,processesTotal:t,processesRunning:n,processesZombie:o,registeredNames:a,registeredAliases:l,registeredEvents:i})=>ue.jsx(g,{colon:!1,size:"small",items:[{key:"1",label:"Applications Total",children:e},{key:"11",label:"Applications Running",children:s},{key:"2",label:"Processes Total",children:t},{key:"3",label:"Processes Running",children:n},{key:"4",label:"Processes Zombie",children:o},{key:"5",label:"Registered Names",children:a},{key:"6",label:"Registered Aliases",children:l},{key:"7",label:"Registered Events",children:i}],column:1}),Gs=()=>ue.jsx(I,{image:I.PRESENTED_IMAGE_SIMPLE}),{Text:Js}=o,Zs=({nodeData:e})=>{const s=(e?.Message.Info.Loggers??[]).map(({Name:e,Behavior:s,Levels:t})=>({key:`${e} ${s}`,label:ue.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[ue.jsxs("div",{children:[ue.jsxs(Js,{children:[e," "]}),ue.jsx(Js,{type:"secondary",style:{fontSize:12},children:s})]}),ue.jsxs("div",{children:[ue.jsx(Js,{type:"secondary",style:{fontSize:12},children:"Enabled Levels:"})," ",ue.jsx(Js,{children:t.length})]})]}),children:ue.jsxs(ye,{children:[ue.jsx(be,{children:ue.jsx(g,{colon:!0,size:"small",items:[{key:"1",label:"trace",children:Ae(t.includes("trace"))},{key:"2",label:"debug",children:Ae(t.includes("debug"))},{key:"4",label:"info",children:Ae(t.includes("info"))}],column:1})}),ue.jsx(be,{children:ue.jsx(g,{colon:!0,size:"small",items:[{key:"11",label:"warning",children:Ae(t.includes("warning"))},{key:"3",label:"error",children:Ae(t.includes("error"))},{key:"5",label:"panic",children:Ae(t.includes("panic"))}],column:1})})]})})).sort((e,s)=>e.label<s.label?-1:e.label>s.label?1:0);return s&&s.length>0?ue.jsx(f,{items:s??[]}):ue.jsx(Gs,{})},{Text:Ys}=o,Xs={processesTotal:"total",processesRunning:"running"},et=({chartBuffer:e})=>ue.jsx("div",{style:{backgroundColor:"#262e35",padding:"10px",borderRadius:"10px"},children:ue.jsx(X,{height:200,width:"100%",children:ue.jsxs(ee,{data:e,children:[ue.jsx(se,{style:{fontFamily:Qe,fontSize:14},formatter:e=>ue.jsx(Ys,{style:{color:"whitesmoke"},children:Xs[e]}),align:"right",verticalAlign:"top",wrapperStyle:{paddingBottom:"5px"}}),ue.jsx(te,{strokeDasharray:"1 2",opacity:.5}),ue.jsx(ne,{dataKey:"xValue",fontFamily:Qe,fontSize:"9pt",type:"number",reversed:!0,tickCount:7,unit:"s"}),ue.jsx(oe,{fontFamily:Qe,fontSize:"9pt",type:"number",allowDecimals:!1}),ue.jsx(ae,{formatter:e=>ue.jsx(Ys,{children:`${e}`})}),ue.jsx(le,{type:"monotone",dataKey:"processesTotal",stroke:"#5db9dc",strokeWidth:2,isAnimationActive:!1,dot:ue.jsx(ue.Fragment,{}),connectNulls:!0}),ue.jsx(le,{type:"monotone",dataKey:"processesRunning",stroke:"#dc695d",strokeWidth:2,isAnimationActive:!1,dot:ue.jsx(ue.Fragment,{}),connectNulls:!0})]})})}),{Text:st}=o,tt={memoryUsed:"used",memoryAlloc:"allocated"},nt=({chartBuffer:e})=>{const s=e.map(e=>({...e,memoryUsed:(e.memoryUsed/1024/1024).toFixed(2),memoryAlloc:(e.memoryAlloc/1024/1024).toFixed(2)}));return ue.jsx("div",{style:{backgroundColor:"#262e35",padding:"10px",borderRadius:"10px"},children:ue.jsx(X,{height:200,width:"100%",children:ue.jsxs(ee,{data:s,children:[ue.jsx(se,{fontFamily:Qe,fontSize:14,style:{fontFamily:Qe,fontSize:14},formatter:e=>ue.jsx(st,{style:{color:"whitesmoke"},children:`${tt[e]}, MB`}),align:"right",verticalAlign:"top",wrapperStyle:{paddingBottom:"5px"}}),ue.jsx(te,{strokeDasharray:"1 2",opacity:.5}),ue.jsx(ne,{dataKey:"xValue",fontFamily:Qe,fontSize:"9pt",type:"number",reversed:!0,tickCount:7,unit:"s"}),ue.jsx(oe,{fontFamily:Qe,fontSize:"9pt",type:"number",allowDecimals:!1}),ue.jsx(ae,{}),ue.jsx(le,{type:"monotone",dataKey:"memoryUsed",stroke:"#5ddc8b",strokeWidth:2,isAnimationActive:!1,connectNulls:!0,dot:ue.jsx(ue.Fragment,{})}),ue.jsx(le,{type:"monotone",dataKey:"memoryAlloc",stroke:"#dcd75d",strokeWidth:2,isAnimationActive:!1,connectNulls:!0,dot:ue.jsx(ue.Fragment,{})})]})})})},ot=({networkData:e})=>ue.jsxs(ye,{children:[ue.jsxs(be,{children:[ue.jsx(g,{colon:!0,size:"small",items:[{key:"1",label:"Mode",children:e?.Message.Info.Mode}],column:1}),ue.jsx(ts,{title:"registrar"}),ue.jsx(g,{colon:!0,size:"small",items:[{key:"1",label:"Version",children:`${e?.Message.Info.Registrar.Version.Name}:${e?.Message.Info.Registrar.Version.Release} ${yt(e?.Message.Info.Registrar.Version.Commit)}`},{key:"2",label:"Server",children:e?.Message.Info.Registrar.Server},{key:"3",label:"Embedded Server",children:Ae(e?.Message.Info.Registrar.EmbeddedServer)},{key:"4",label:'Support "Register Proxy"',children:Ae(e?.Message.Info.Registrar.SupportRegisterProxy)},{key:"5",label:'Support "Register Application"',children:Ae(e?.Message.Info.Registrar.SupportRegisterApplication)},{key:"6",label:'Support "Live Config"',children:Ae(e?.Message.Info.Registrar.SupportConfig)},{key:"7",label:'Support "Event Updates"',children:Ae(e?.Message.Info.Registrar.SupportEvent)}],column:1,layout:"horizontal"})]}),ue.jsxs(be,{children:[ue.jsx(g,{colon:!0,size:"small",items:[{key:"1",label:"Max Message Size (bytes)",children:e?.Message.Info.MaxMessageSize},{key:"2",label:"Handshake Version",children:`${e?.Message.Info.HandshakeVersion.Name}:${e?.Message.Info.HandshakeVersion.Release} ${yt(e?.Message.Info.HandshakeVersion.Commit)}`},{key:"3",label:"Proto Version",children:`${e?.Message.Info.ProtoVersion.Name}:${e?.Message.Info.ProtoVersion.Release} ${yt(e?.Message.Info.ProtoVersion.Commit)}`}],column:1}),ue.jsx(ts,{title:"flags"}),ue.jsx(g,{colon:!0,size:"small",items:[{key:"1",label:'Enable "Remote Spawn"',children:Ae(e?.Message.Info.Flags.EnableRemoteSpawn)},{key:"2",label:'Enable "Remote Application Start"',children:Ae(e?.Message.Info.Flags.EnableRemoteApplicationStart)},{key:"3",label:'Enable "Proxy Transit"',children:Ae(e?.Message.Info.Flags.EnableProxyTransit)},{key:"4",label:'Enable "Proxy Accept"',children:Ae(e?.Message.Info.Flags.EnableProxyAccept)},{key:"5",label:'Enable "Important Delivery"',children:Ae(e?.Message.Info.Flags.EnableImportantDelivery)}],column:1,layout:"horizontal"})]})]}),at=({networkData:e})=>ue.jsxs(ue.Fragment,{children:[ue.jsx(ts,{title:"acceptors"}),e&&(e.Message.Info.Acceptors??[]).length>0?ue.jsx(f,{items:e?.Message.Info.Acceptors?.map(({Interface:e,MaxMessageSize:s,CustomRegistrar:t,RegistrarServer:n,RegistrarVersion:o,HandshakeVersion:a,ProtoVersion:l,TLS:i,Flags:r})=>({key:e,label:e,children:ue.jsxs(ye,{children:[ue.jsx(be,{children:ue.jsx(g,{colon:!0,size:"small",items:[{key:"1",label:"Max Message Size (bytes)",children:s},{key:"2",label:"Custom Registrar",children:Ae(t)},{key:"3",label:"Registrar Server",children:n},{key:"4",label:"Registrar Version",children:`${o.Name}:${o.Release} ${yt(o.Commit)}`},{key:"5",label:"Handshake Version",children:`${a.Name}:${a.Release} ${yt(a.Commit)}`},{key:"6",label:"Proto Version",children:`${l.Name}:${l.Release} ${yt(l.Commit)}`},{key:"7",label:"TLS",children:Ae(i)}],column:1,layout:"horizontal"})}),ue.jsxs(be,{children:[ue.jsx(y,{orientation:"left",plain:!0,style:{margin:0,color:"#7d7d7d"},children:"flags"}),ue.jsx(g,{colon:!0,size:"small",items:[{key:"0",label:"Enable",children:Ae(r.Enable)},{key:"1",label:'Enable "Remote Spawn"',children:Ae(r.EnableRemoteSpawn)},{key:"2",label:'Enable "Remote Application Start"',children:Ae(r.EnableRemoteApplicationStart)},{key:"3",label:'Enable "Proxy Transit"',children:Ae(r.EnableProxyTransit)},{key:"4",label:'Enable "Proxy Accept"',children:Ae(r.EnableProxyAccept)},{key:"5",label:'Enable "Important Delivery"',children:Ae(r.EnableImportantDelivery)}],column:1,layout:"horizontal"})]})]})})),onChange:()=>{}}):ue.jsx(Gs,{})]}),{Text:lt}=o,it=({networkData:e})=>ue.jsxs(ue.Fragment,{children:[ue.jsx(ts,{title:"enabled remote spawn"}),e&&(e.Message.Info.EnabledSpawn??[]).length>0?ue.jsx(f,{items:e?.Message.Info.EnabledSpawn?.map(({Name:e,Behavior:s,Nodes:t},n)=>({key:n,label:ue.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[ue.jsxs("div",{children:[ue.jsxs(lt,{children:[e," "]}),ue.jsx(lt,{type:"secondary",style:{fontSize:12},children:s})]}),ue.jsxs("div",{children:[ue.jsx(lt,{type:"secondary",style:{fontSize:12},children:"Allowed Nodes:"})," ",ue.jsx(lt,{children:t.length>0?t.length:"any"})]})]}),children:t.join(", ")}))}):ue.jsx(Gs,{})]}),{Text:rt}=o,ct=({networkData:e})=>ue.jsxs(ue.Fragment,{children:[ue.jsx(ts,{title:"enabled remote application start"}),e&&(e.Message.Info.EnabledApplicationStart??[]).length>0?ue.jsx(f,{items:e?.Message.Info.EnabledApplicationStart?.map(({Name:e,Nodes:s},t)=>({key:t,label:ue.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[ue.jsx("div",{children:ue.jsx(rt,{children:e})}),ue.jsxs("div",{children:[ue.jsx(rt,{type:"secondary",style:{fontSize:12},children:"Allowed Nodes:"})," ",ue.jsx(rt,{children:s.length>0?s.length:"any"})]})]}),children:s.join(", ")}))}):ue.jsx(Gs,{})]}),dt=({networkData:e})=>ue.jsxs(ue.Fragment,{children:[ue.jsx(ts,{title:"static routes"}),e&&(e.Message.Info.Routes??[]).length>0?ue.jsx(f,{items:e?.Message.Info.Routes?.map(({HandshakeVersion:e,ProtoVersion:s,Flags:t,Match:n,Weight:o,UseResolver:a,UseCustomCookie:l,UseCustomCert:i})=>({key:n,label:n,children:ue.jsxs(ye,{children:[ue.jsx(be,{children:ue.jsx(g,{colon:!0,size:"small",items:[{key:"1",label:"Weight",children:o},{key:"2",label:"Use Resolver",children:Ae(a)},{key:"3",label:"Use Custom Cookie",children:Ae(l)},{key:"4",label:"Use Custom Cert Manager",children:Ae(i)},{key:"5",label:"Handshake Version",children:`${e.Name}:${e.Release} ${yt(e.Commit)}`},{key:"6",label:"Proto Version",children:`${s.Name}:${s.Release} ${yt(s.Commit)}`}],column:1,layout:"horizontal"})}),ue.jsxs(be,{children:[ue.jsx(y,{orientation:"left",plain:!0,style:{margin:0,color:"#7d7d7d"},children:"flags"}),ue.jsx(g,{colon:!0,size:"small",items:[{key:"0",label:"Enable",children:Ae(t.Enable)},{key:"1",label:'Enable "Remote Spawn"',children:Ae(t.EnableRemoteSpawn)},{key:"2",label:'Enable "Remote Application Start"',children:Ae(t.EnableRemoteApplicationStart)},{key:"3",label:'Enable "Proxy Transit"',children:Ae(t.EnableProxyTransit)},{key:"4",label:'Enable "Proxy Accept"',children:Ae(t.EnableProxyAccept)},{key:"5",label:'Enable "Important Delivery"',children:Ae(t.EnableImportantDelivery)}],column:1,layout:"horizontal"})]})]})})),onChange:()=>{}}):ue.jsx(Gs,{})]}),mt=({networkData:e})=>ue.jsxs(ue.Fragment,{children:[ue.jsx(ts,{title:"proxy routes"}),e&&(e.Message.Info.ProxyRoutes??[]).length>0?ue.jsx(f,{items:e?.Message.Info.ProxyRoutes?.map(({Flags:e,Match:s,Weight:t,UseResolver:n,UseCustomCookie:o,Proxy:a,MaxHop:l})=>({key:s,label:s,children:ue.jsxs(ye,{children:[ue.jsx(be,{children:ue.jsx(g,{colon:!0,size:"small",items:[{key:"1",label:"Weight",children:t},{key:"11",label:"Proxy",children:a},{key:"2",label:"Use Resolver",children:Ae(n)},{key:"3",label:"Use Custom Cookie",children:Ae(o)},{key:"4",label:"Max Hop",children:l}],column:1,layout:"horizontal"})}),ue.jsxs(be,{children:[ue.jsx(y,{orientation:"left",plain:!0,style:{margin:0,color:"#7d7d7d"},children:"flags"}),ue.jsx(g,{colon:!0,size:"small",items:[{key:"0",label:"Enable",children:Ae(e.Enable)},{key:"1",label:'Enable "Remote Spawn"',children:Ae(e.EnableRemoteSpawn)},{key:"2",label:'Enable "Remote Application Start"',children:Ae(e.EnableRemoteApplicationStart)},{key:"3",label:'Enable "Encryption"',children:Ae(e.EnableEncryption)},{key:"4",label:'Enable "Important Delivery"',children:Ae(e.EnableImportantDelivery)}],column:1,layout:"horizontal"})]})]})})),onChange:()=>{}}):ue.jsx(Gs,{})]}),{Text:ut}=o,ht={messagesIn:"in",messagesOut:"out",bytesIn:"in",bytesOut:"out"},pt=({chartBuffer:e})=>ue.jsx("div",{style:{backgroundColor:"#262e35",padding:"10px",borderRadius:"10px"},children:ue.jsx(X,{height:200,width:"100%",children:ue.jsxs(ee,{data:e,children:[ue.jsx(se,{style:{fontFamily:Qe,fontSize:14},formatter:e=>ue.jsx(ut,{style:{color:"whitesmoke"},children:ht[e]}),align:"right",verticalAlign:"top",wrapperStyle:{paddingBottom:"5px"}}),ue.jsx(te,{strokeDasharray:"1 2",opacity:.5}),ue.jsx(ne,{dataKey:"xValue",fontFamily:Qe,fontSize:"9pt",type:"number",reversed:!0,tickCount:7,unit:"s"}),ue.jsx(oe,{fontFamily:Qe,fontSize:"9pt",type:"number",allowDecimals:!1}),ue.jsx(ae,{}),ue.jsx(le,{type:"monotone",dataKey:"messagesIn",stroke:"#dc695d",strokeWidth:2,isAnimationActive:!1,dot:ue.jsx(ue.Fragment,{}),connectNulls:!0}),ue.jsx(le,{type:"monotone",dataKey:"messagesOut",stroke:"#5db9dc",strokeWidth:2,isAnimationActive:!1,dot:ue.jsx(ue.Fragment,{}),connectNulls:!0})]})})}),gt=({chartBuffer:e})=>ue.jsx("div",{style:{backgroundColor:"#262e35",padding:"10px",borderRadius:"10px"},children:ue.jsx(X,{height:200,width:"100%",children:ue.jsxs(ee,{data:e,children:[ue.jsx(se,{style:{fontFamily:Qe,fontSize:14},formatter:e=>ue.jsx(ut,{style:{color:"whitesmoke"},children:ht[e]}),align:"right",verticalAlign:"top",wrapperStyle:{paddingBottom:"5px"}}),ue.jsx(te,{strokeDasharray:"1 2",opacity:.5}),ue.jsx(ne,{dataKey:"xValue",fontFamily:Qe,fontSize:"9pt",type:"number",reversed:!0,tickCount:7,unit:"s"}),ue.jsx(oe,{fontFamily:Qe,fontSize:"9pt",type:"number",allowDecimals:!1}),ue.jsx(ae,{}),ue.jsx(le,{type:"monotone",dataKey:"bytesIn",stroke:"#dcd75d",strokeWidth:2,isAnimationActive:!1,dot:ue.jsx(ue.Fragment,{}),connectNulls:!0}),ue.jsx(le,{type:"monotone",dataKey:"bytesOut",stroke:"#5ddc8b",strokeWidth:2,isAnimationActive:!1,dot:ue.jsx(ue.Fragment,{}),connectNulls:!0})]})})}),xt=({networkData:e})=>{const{commonContext:{nodeName:s}}=xe(),{networkConnectedNodesStore:t}=zs();return n.useEffect(()=>{t.updateNodesInfo()},[e?.Message.Info.Nodes]),ue.jsxs(ue.Fragment,{children:[ue.jsx(ts,{title:"connected nodes"}),e&&(e.Message.Info.Nodes??[]).length>0?ue.jsx(f,{items:e?.Message.Info.Nodes?.map(e=>({key:e,label:e,children:ue.jsx(ft,{nodeName:e},e)}))},s):ue.jsx(Gs,{})]})},ft=Z(({nodeName:e})=>{const{networkConnectedNodesStore:s}=zs(),t=Y(s.nodeMap[e]),o=t?.data;return n.useEffect(()=>{t?.subsribed||s.addNodeToSubscribe(e)},[t?.subsribed]),ue.jsxs("div",{children:[ue.jsxs(ye,{children:[ue.jsx(be,{children:ue.jsx(g,{colon:!0,size:"small",items:[{key:"1",label:"Connection Uptime",children:o?.Message.Info.ConnectionUptime&&ue.jsx(Ve,{uptime:o.Message.Info.ConnectionUptime})},{key:"2",label:"Remote Node Uptime",children:o?.Message.Info.Uptime&&ue.jsx(Ve,{uptime:o.Message.Info.Uptime})},{key:"3",label:"Version",children:`${o?.Message.Info.Version.Name}:${o?.Message.Info.Version.Release} ${yt(o?.Message.Info.Version.Commit)}`},{key:"4",label:"Handshake Version",children:`${o?.Message.Info.HandshakeVersion.Name}:${o?.Message.Info.HandshakeVersion.Release} ${yt(o?.Message.Info.HandshakeVersion.Commit)}`},{key:"5",label:"Proto Version",children:`${o?.Message.Info.ProtoVersion.Name}:${o?.Message.Info.ProtoVersion.Release} ${yt(o?.Message.Info.ProtoVersion.Commit)}`},{key:"6",label:"Pool Size",children:o?.Message.Info.PoolSize},{key:"7",label:"Pool DSN",children:o?.Message.Info.PoolDSN?.join(", ")}],column:1,layout:"horizontal"})}),ue.jsxs(be,{children:[ue.jsx(g,{colon:!0,size:"small",items:[{key:"8",label:"Max Message Size (bytes)",children:o?.Message.Info.MaxMessageSize}],column:1,layout:"horizontal"}),ue.jsx(y,{orientation:"left",plain:!0,style:{margin:0,color:"#7d7d7d"},children:"flags"}),ue.jsx(g,{colon:!0,size:"small",items:[{key:"0",label:"Enable",children:Ae(o?.Message.Info.NetworkFlags.Enable)},{key:"2",label:'Enable "Remote Application Start"',children:Ae(o?.Message.Info.NetworkFlags.EnableRemoteApplicationStart)},{key:"1",label:'Enable "Remote Spawn"',children:Ae(o?.Message.Info.NetworkFlags.EnableRemoteSpawn)},{key:"3",label:'Enable "Proxy Transit"',children:Ae(o?.Message.Info.NetworkFlags.EnableProxyTransit)},{key:"4",label:'Enable "Important Delivery"',children:Ae(o?.Message.Info.NetworkFlags.EnableImportantDelivery)}],column:1,layout:"horizontal"})]})]}),ue.jsx(ts,{title:"messages"}),ue.jsx(pt,{chartBuffer:t?.messagesBufferRef??[]}),ue.jsxs(ye,{children:[ue.jsx(be,{children:ue.jsx(g,{colon:!0,size:"small",items:[{key:"0",label:"Total In",children:o?.Message.Info.MessagesIn}],column:1,layout:"horizontal"})}),ue.jsx(be,{children:ue.jsx(g,{colon:!0,size:"small",items:[{key:"0",label:"Total Out",children:o?.Message.Info.MessagesOut}],column:1,layout:"horizontal"})})]}),ue.jsx(ts,{title:"traffic"}),ue.jsx(gt,{chartBuffer:t?.bytesBufferRef??[]}),ue.jsxs(ye,{children:[ue.jsx(be,{children:ue.jsx(g,{colon:!0,size:"small",items:[{key:"0",label:"Total In",children:o?.Message.Info.BytesIn}],column:1,layout:"horizontal"})}),ue.jsx(be,{children:ue.jsx(g,{colon:!0,size:"small",items:[{key:"0",label:"Total Out",children:o?.Message.Info.BytesOut}],column:1,layout:"horizontal"})})]})]})}),yt=e=>e?`<${e.slice(0,8)}>`:"",bt=Z(()=>{const{networkStore:{networkDataToRender:e}}=zs();return ue.jsxs("div",{children:[ue.jsx(ot,{networkData:e}),ue.jsx(at,{networkData:e}),ue.jsx(xt,{networkData:e}),ue.jsx(it,{networkData:e}),ue.jsx(ct,{networkData:e}),ue.jsx(dt,{networkData:e}),ue.jsx(mt,{networkData:e})]})}),{Text:jt}=o,vt=Z(({nodeData:e})=>{const s=e?.Message.Info.Cron;if(!s||!s.Jobs||0===s.Jobs.length)return ue.jsx(Gs,{});const t=e=>{if(!e||"0001-01-01T00:00:00Z"===e)return"Never";try{return new Date(e).toLocaleString()}catch{return"Invalid date"}},n=s.Jobs.map(e=>({key:e.Name,label:ue.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[ue.jsx("div",{children:ue.jsxs(jt,{children:[e.Name," "]})}),ue.jsxs("div",{style:{display:"flex",alignItems:"baseline",gap:"8px"},children:[e.LastErr&&ue.jsx(jt,{type:"secondary",style:{fontSize:12,color:"#ff4d4f"},children:"error"}),ue.jsxs("span",{children:[ue.jsx(jt,{type:"secondary",style:{fontSize:12},children:"Spec:"})," ",ue.jsx(jt,{style:{fontSize:12},children:e.Spec})]})]})]}),children:ue.jsxs(ye,{children:[ue.jsx(be,{children:ue.jsx(g,{colon:!0,size:"small",items:[{key:"1",label:"Action",children:e.ActionInfo||"Not specified"},{key:"2",label:"Status",children:e.Disabled?"Disabled":"Active"},{key:"3",label:"Location",children:e.Location}],column:1})}),ue.jsx(be,{children:ue.jsx(g,{colon:!0,size:"small",items:[{key:"4",label:"Last Run",children:t(e.LastRun)},{key:"5",label:"Last Error",children:e.LastErr||"None"},{key:"6",label:"Fallback",children:e.Fallback?.Enable?ue.jsxs("span",{children:[e.Fallback.Name,e.Fallback.Tag&&ue.jsxs(jt,{type:"secondary",style:{fontSize:11},children:[" ","(",e.Fallback.Tag,")"]})]}):"Disabled"}],column:1})})]})})).sort((e,s)=>e.key<s.key?-1:e.key>s.key?1:0);return ue.jsx(f,{items:n})}),kt=Z(()=>{const{commonContext:{os:e,architecture:s,cpuCores:t}}=xe(),{nodeStore:n}=zs(),{nodeDataToRender:o,processesBufferRefToRender:a,memoryBufferRefToRender:l}=n;return ue.jsxs("div",{children:[ue.jsxs(ye,{children:[ue.jsx(be,{children:ue.jsx(Ws,{nodeName:o?.Message.Info.Name??"",version:`${o?.Message.Info.Version.Release??""} ${o?.Message.Info.Version.Name??""} ${yt(o?.Message.Info.Version.Commit)}`,ergoFramework:o?.Message.Info.Framework.Release??"",os:e,architecture:s,cpuCores:t,memoryUsed:o?String(o.Message.Info.MemoryUsed):"",uptime:o?String(o.Message.Info.Uptime):"",logLevel:o?.Message.Info.LogLevel??""})}),ue.jsx(be,{children:ue.jsx(Qs,{applicationsTotal:o?.Message.Info.ApplicationsTotal??0,applicationsRunning:o?.Message.Info.ApplicationsRunning??0,processesTotal:o?.Message.Info.ProcessesTotal??0,processesRunning:o?.Message.Info.ProcessesRunning??0,processesZombie:o?.Message.Info.ProcessesZombee??0,registeredNames:o?.Message.Info.RegisteredNames??0,registeredAliases:o?.Message.Info.RegisteredAliases??0,registeredEvents:o?.Message.Info.RegisteredEvents??0})})]}),ue.jsx(ts,{title:"processes"}),ue.jsx(et,{chartBuffer:a}),ue.jsx(ts,{title:"memory"}),ue.jsx(nt,{chartBuffer:l}),ue.jsx(ts,{title:"loggers"}),ue.jsx(Zs,{nodeData:o}),ue.jsx(ts,{title:"cron"}),ue.jsx(vt,{nodeData:o}),ue.jsx(ts,{title:"environment variables"}),ue.jsx(ms,{dataSource:Object.entries(o?.Message.Info.Env??{}).map(([e,s])=>({key:e,name:e,value:Ss(s)}))})]})}),Mt=n.memo(({application:e,nodeName:s})=>{const t=n.useMemo(()=>[{key:"0",label:"Description",children:e.Description||"No description"},{key:"1",label:"Mode",children:e.Mode},{key:"2",label:"State",children:e.State},{key:"3",label:"Weight",children:e.Weight},{key:"4",label:"Parent",children:e.Parent||s}],[e.Description,e.Mode,e.State,e.Weight,e.Parent,s]),o=n.useMemo(()=>[{key:"0",label:"Uptime (sec)",children:e.Uptime},{key:"1",label:"Process Count",children:e.Group.length},{key:"2",label:"Dependencies",children:e.Depends.Applications.length>0?e.Depends.Applications.join(", "):"None"},{key:"3",label:"Network Required",children:e.Depends.Network?"Yes":"No"},{key:"4",label:"Version",children:e.Version.Name||"Not specified"}],[e.Uptime,e.Group.length,e.Depends.Applications,e.Depends.Network,e.Version.Name]),a=n.useMemo(()=>Object.entries(e.Env??{}).map(([e,s])=>({key:e,name:e,value:Ss(s)})),[e.Env]);return ue.jsxs("div",{children:[ue.jsxs(ye,{children:[ue.jsx(be,{children:ue.jsx(g,{colon:!0,size:"small",items:t,column:1,layout:"horizontal"})}),ue.jsx(be,{children:ue.jsx(g,{colon:!0,size:"small",items:o,column:1,layout:"horizontal"})})]}),ue.jsx(ts,{title:"environment variables"}),ue.jsx(ms,{dataSource:a})]})});Mt.displayName="ApplicationContent";const St=Z(()=>{const{applicationsStore:e}=zs(),{commonContext:{nodeName:s}}=xe();n.useEffect(()=>(e.tryToSubscribeApplicationListData(),()=>{e.unsubscribeApplicationData()}),[e]);const t=n.useMemo(()=>{const s=e.applicationListData?.Message?.Applications;return s?Object.values(s):[]},[e.applicationListData?.Message?.Applications]),o=n.useMemo(()=>t.map(e=>({key:e.Name,label:ue.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[ue.jsx("div",{children:e.Name}),ue.jsxs("div",{style:{color:"#7d7d7d"},children:[e.Mode," - ",e.State]})]}),children:ue.jsx(Mt,{application:e,nodeName:s})})),[t,s]);return 0===t.length?ue.jsx(Gs,{}):ue.jsx("div",{children:ue.jsx(f,{items:o})})});St.displayName="ApplicationsTabContent";const Ct=({children:e})=>ue.jsx("div",{style:{padding:"5px 5px"},children:e}),It=[{key:"info",label:"Info",children:ue.jsx(Ct,{children:ue.jsx(kt,{})})},{key:"network",label:"Network",children:ue.jsx(Ct,{children:ue.jsx(bt,{})})},{key:"applications",label:"Applications",children:ue.jsx(Ct,{children:ue.jsx(St,{})})},{key:"processes",label:"Processes",children:ue.jsx(Ct,{children:ue.jsx(He,{})})},{key:"log",label:"Log",children:ue.jsx(Ct,{children:ue.jsx("div",{style:{minHeight:"calc(100vh - 40px - 50px - 10px - 80px"},children:ue.jsx(vs,{})})})}],Rt=()=>{const e=z(),s=A(),{crc:t}=$(),n=(o=e.pathname)===`/${t}/info`?"info":o===`/${t}/network`?"network":o===`/${t}/processes`?"processes":o===`/${t}/applications`?"applications":o===`/${t}/log`?"log":void 0;var o;return ue.jsx(D,{defaultActiveKey:"info",activeKey:n,items:It,onChange:e=>s(`/${t}/${e}`)})},wt=()=>ue.jsx("img",{src:"data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3csvg%20viewBox='315.536%20195.8756%204.0038%205.757'%20width='4.0038'%20height='5.757'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='path30252'%20style='fill:%23a0a0a0;fill-opacity:1;stroke-width:0.0155624'%20d='m%20227.03712,358.65407%20c%20-1.73415,2.6e-4%20-1.82025,9.2e-4%20-1.88315,0.0283%20-0.0771,0.0324%20-0.12922,0.0888%20-0.1529,0.16474%20-0.0116,0.0369%20-0.0154,0.78804%20-0.0116,2.35656%20l%200.004,2.30248%200.0432,0.0604%20c%200.0871,0.12228%200.0339,0.11681%201.20463,0.12165%20l%201.03802,0.004%20v%200.34131%20c%200,0.24548%200.005,0.34613%200.0196,0.35904%20v%204.1e-4%20c%200.0332,0.0308%200.0617,0.0208%200.19933,-0.0705%200.21388,-0.142%200.18108,-0.14061%200.37272,-0.0182%200.0917,0.0585%200.17784,0.10687%200.19113,0.10687%200.0488,0%200.0578,-0.0577%200.0578,-0.38903%20v%20-0.33073%20h%200.40002%20c%200.44368,0%200.47193,-0.005%200.47193,-0.0895%200,-0.0885%20-0.0101,-0.0903%20-0.46147,-0.0903%20h%20-0.41048%20v%20-0.1047%20-0.10519%20h%20-0.42004%20-0.42005%20v%200.10519%200.1047%20h%20-0.98707%20c%20-1.09157,0%20-1.07,9.1e-4%20-1.12406,-0.095%20-0.0576,-0.10363%20-0.0191,-0.21569%200.0928,-0.26866%200.0518,-0.0243%200.17355,-0.0261%201.84037,-0.0266%201.37796,-4.1e-4%201.79058,-0.004%201.80986,-0.0185%200.0136,-0.01%200.0377,-0.035%200.0528,-0.0554%200.0259,-0.0345%200.0273,-0.18393%200.0273,-2.14704%200,-1.33423%20-0.005,-2.12353%20-0.0154,-2.1479%20-0.009,-0.0212%20-0.0396,-0.052%20-0.0686,-0.0684%20-0.0521,-0.0295%20-0.0824,-0.0302%20-1.8704,-0.03%20z%20m%20-1.1541,0.62178%20h%202.00738%20a%200.11668497,0.16836631%200%200%201%200.11694,0.16853%200.11668497,0.16836631%200%200%201%20-0.11694,0.16897%20h%20-2.00738%20a%200.11668497,0.16836631%200%200%201%20-0.11693,-0.16897%200.11668497,0.16836631%200%200%201%200.11693,-0.16853%20z%20m%200.48238,0.82705%20h%201.66562%20a%200.09684615,0.16836631%200%200%201%200.0973,0.16897%200.09684615,0.16836631%200%200%201%20-0.0973,0.16853%20h%20-1.66562%20a%200.09684615,0.16836631%200%200%201%20-0.0974,-0.16853%200.09684615,0.16836631%200%200%201%200.0974,-0.16897%20z%20m%20-0.20934,0.88366%20h%201.46492%20c%200.0537,-2.2e-4%200.097,0.0757%200.0969,0.16897%201.3e-4,0.0933%20-0.0433,0.16875%20-0.0969,0.16854%20h%20-1.46492%20c%20-0.0537,2.1e-4%20-0.097,-0.0753%20-0.0969,-0.16854%20-1.1e-4,-0.0933%200.0433,-0.16919%200.0969,-0.16897%20z'%20transform='matrix(1,%200,%200,%201,%2090.54792022705078,%20-162.77845764160156)'/%3e%3c/svg%3e",style:{height:"20px",width:"20px"}}),Nt=()=>ue.jsx("img",{src:"data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3csvg%20viewBox='372.8183%20193.4534%205.4116%205.4116'%20width='5.4116'%20height='5.4116'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='circle10-3-5'%20style='fill:%23a7a7a7;fill-opacity:1;stroke-width:0.117641'%20d='m%20236.3954,358.41523%20a%202.7057405,2.7057405%200%200%200%20-2.70579,2.70579%202.7057405,2.7057405%200%200%200%202.70579,2.70578%202.7057405,2.7057405%200%200%200%202.70578,-2.70578%202.7057405,2.7057405%200%200%200%20-2.70578,-2.70579%20z%20m%20-6e-4,1.1389%20c%200.18826,0%200.34079,0.15324%200.34079,0.34231%200,0.1491%20-0.0949,0.27607%20-0.22729,0.32305%20v%200.78069%20c%200.1324,0.047%200.22729,0.17396%200.22729,0.32305%200,0.18908%20-0.15253,0.34231%20-0.34079,0.34231%20-0.18826,0%20-0.34078,-0.15323%20-0.34078,-0.34231%200,-0.14903%200.0946,-0.27601%200.22698,-0.32305%20v%20-0.78069%20c%20-0.13233,-0.047%20-0.22698,-0.17401%20-0.22698,-0.32305%200,-0.18907%200.15252,-0.34231%200.34078,-0.34231%20z%20m%20-0.86113,0.79905%20c%200.003,-8e-5%200.005,0%200.009,0%200.18826,0%200.34078,0.15323%200.34078,0.34232%200,0.14906%20-0.0949,0.27573%20-0.22729,0.32274%20v%200.78098%20c%200.13242,0.047%200.22729,0.17367%200.22729,0.32273%200,0.18909%20-0.15252,0.34232%20-0.34078,0.34232%20-0.18826,0%20-0.34079,-0.15323%20-0.34079,-0.34232%200,-0.14906%200.0949,-0.27573%200.2273,-0.32273%20v%20-0.78098%20c%20-0.13241,-0.0471%20-0.2273,-0.17368%20-0.2273,-0.32274%200,-0.18613%200.14772,-0.33764%200.33192,-0.34232%20z%20m%201.70453,0%20c%200.003,-8e-5%200.005,0%200.009,0%200.18826,0%200.34079,0.15323%200.34079,0.34232%200,0.14906%20-0.0949,0.27573%20-0.2273,0.32274%20v%200.78098%20c%200.13241,0.047%200.2273,0.17367%200.2273,0.32273%200,0.18909%20-0.15253,0.34232%20-0.34079,0.34232%20-0.18826,0%20-0.34109,-0.15323%20-0.34109,-0.34232%200,-0.14906%200.0949,-0.27573%200.22729,-0.32273%20v%20-0.78098%20c%20-0.13241,-0.0471%20-0.22729,-0.17368%20-0.22729,-0.32274%200,-0.18613%200.14803,-0.33764%200.33223,-0.34232%20z%20m%20-2.49991,0.68463%20c%200.003,-7e-5%200.005,0%200.009,0%200.18826,0%200.34079,0.15324%200.34079,0.34232%200,0.18908%20-0.15253,0.34231%20-0.34079,0.34231%20-0.18825,0%20-0.34078,-0.15323%20-0.34078,-0.34231%200,-0.18612%200.14771,-0.33764%200.33191,-0.34232%20z%20m%203.35187,0%20c%200.003,-7e-5%200.005,0%200.009,0%200.18826,0%200.34079,0.15324%200.34079,0.34232%200,0.18908%20-0.15253,0.34231%20-0.34079,0.34231%20-0.18826,0%20-0.34079,-0.15323%20-0.34079,-0.34231%200,-0.18612%200.14773,-0.33764%200.33192,-0.34232%20z'%20transform='matrix(0.9999999999999999,%200,%200,%200.9999999999999999,%20139.12869262695312,%20-164.96185302734375)'/%3e%3c/svg%3e",style:{height:"20px",width:"20px"}}),Dt=()=>ue.jsx("img",{src:"data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3csvg%20viewBox='478.6894%20196.2253%205.4222%205.2883'%20width='5.4222'%20height='5.2883'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20style='clip-rule:evenodd;fill:%23a0a0a0;fill-opacity:1;fill-rule:evenodd'%20d='m%2012,0.296%20c%20-6.627,0%20-12,5.372%20-12,12%200,5.302%203.438,9.8%208.206,11.387%200.6,0.111%200.82,-0.26%200.82,-0.577%20C%209.026,22.82%209.015,21.875%209.01,20.872%205.672,21.598%204.967,19.456%204.967,19.456%204.421,18.069%203.635,17.7%203.635,17.7%202.546,16.955%203.717,16.971%203.717,16.971%20c%201.205,0.085%201.839,1.237%201.839,1.237%201.07,1.834%202.807,1.304%203.492,0.997%20C%209.156,18.429%209.467,17.9%209.81,17.6%207.145,17.297%204.343,16.268%204.343,11.67%204.343,10.36%204.812,9.289%205.58,8.449%205.455,8.146%205.044,6.926%205.696,5.273%20c%200,0%201.008,-0.322%203.301,1.23%20C%209.954,6.237%2010.98,6.104%2012,6.099%20c%201.02,0.005%202.047,0.138%203.006,0.404%202.29,-1.553%203.297,-1.23%203.297,-1.23%200.653,1.653%200.242,2.873%200.118,3.176%200.769,0.84%201.235,1.911%201.235,3.221%200,4.609%20-2.807,5.624%20-5.479,5.921%200.43,0.372%200.814,1.103%200.814,2.222%200,1.606%20-0.014,2.898%20-0.014,3.293%200,0.319%200.216,0.694%200.824,0.576%204.766,-1.589%208.2,-6.085%208.2,-11.385%20C%2024,5.669%2018.627,0.296%2012,0.296%20Z'%20id='path25663'%20transform='matrix(0.22591654956340793,%200,%200,%200.22591654956340793,%20478.6893844604492,%20196.1584267616272)'/%3e%3c/svg%3e",style:{height:"20px",width:"20px"}}),{Text:Tt,Link:Et}=o,Lt=()=>{const{commonContext:{release:e,commit:s,productName:t}}=xe();return ue.jsx("footer",{style:{position:"fixed",bottom:0,height:"40px"},children:ue.jsx("div",{style:{display:"flex",justifyContent:"center",width:"100vw",height:"100%"},children:ue.jsx("div",{style:{width:"850px",borderColor:"black",background:"#ffffff",boxShadow:"0px -3px 8px -5px #373737",textAlign:"center"},children:ue.jsx("div",{style:{padding:"10px 10px"},children:ue.jsxs(ye,{children:[ue.jsxs(Tt,{style:{color:"#a0a0a0"},children:[t," ",e," ",yt(s)]}),ue.jsxs("div",{style:{width:"15%",display:"flex",justifyContent:"space-around"},children:[ue.jsx(Et,{href:"https://github.com/ergo-services",target:"_blank",children:ue.jsx(Dt,{})}),ue.jsx(Et,{href:"https://docs.ergo.services",target:"_blank",children:ue.jsx(wt,{})}),ue.jsx(Et,{href:"https://ergo.services",target:"_blank",children:ue.jsx(Nt,{})})]})]})})})})})},{Text:Pt}=o,{TextArea:$t}=a,At=[{key:"send",label:"Send Message..."},{key:"send_exit",label:"Send Exit-signal..."}],zt=[{value:"normal",label:"normal"},{value:"shutdown",label:"shutdown"},{value:"custom",label:"custom..."}],Bt=Z(()=>{const{websocketStore:e}=zs(),{pid:s}=$(),[t,o]=n.useState(""),[a,c]=n.useState(""),[m,u]=n.useState(""),[h,p]=n.useState("normal"),g=()=>{o(""),c(""),u(""),p("normal")};return ue.jsxs(ue.Fragment,{children:[ue.jsx(l,{menu:{items:At,selectedKeys:[],onSelect:e=>{o(e.key)},selectable:!0},trigger:["click"],children:ue.jsx(i,{style:{paddingRight:"20px"}})}),ue.jsx(r,{title:ue.jsx("div",{children:ue.jsx("div",{children:ue.jsx(Pt,{type:"secondary",style:{fontSize:16},children:"Send Message"})})}),open:"send"===t,onOk:()=>{e.sendMessage(`\n          {\n            "CID": "${P()}",\n            "Command": "do",\n            "Name": "send_meta",\n            "Args":\n              {"ID":"${s}", "Message": "${a}"}\n        }\n          `),g()},okText:"Send",onCancel:()=>{g()},closable:!1,children:ue.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"5px"},children:[ue.jsxs("div",{children:[ue.jsx(Pt,{type:"secondary",children:"To:"})," ",ue.jsx(Pt,{children:s})]}),ue.jsx($t,{value:a,onChange:e=>c(e.target.value),placeholder:"enter message here",autoSize:{minRows:3,maxRows:5},ref:e=>{setTimeout(()=>e?.focus(),0)}})]})}),ue.jsx(r,{title:ue.jsx("div",{children:ue.jsx("div",{children:ue.jsx(Pt,{type:"secondary",style:{fontSize:16},children:"Send Exit-signal"})})}),open:"send_exit"===t,onOk:()=>{e.sendMessage(`\n          {\n            "CID": "${P()}",\n            "Command": "do",\n            "Name": "send_exit_meta",\n            "Args":\n              {"ID":"${s}", "Reason": "${"custom"===h?m:h}"}\n        }\n          `),g()},okText:"Send Exit",onCancel:()=>{g()},closable:!1,okButtonProps:{danger:!0},children:ue.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[ue.jsx("div",{style:{display:"flex",justifyContent:"space-between"},children:ue.jsxs("span",{children:[ue.jsx(Pt,{type:"secondary",children:"To:"})," ",ue.jsx(Pt,{children:s})]})}),ue.jsxs("div",{children:[ue.jsx(Pt,{type:"secondary",children:"Reason:"})," ",ue.jsx(d,{defaultValue:"normal",style:{width:120},onChange:e=>{p(e)},options:zt})]}),ue.jsx("div",{style:{paddingTop:"5px"},children:ue.jsx($t,{disabled:"custom"!==h,value:m,onChange:e=>u(e.target.value),placeholder:"enter reason here",autoSize:{minRows:1,maxRows:5},ref:e=>{setTimeout(()=>e?.focus(),0)}})})]})})]})}),{Text:Ft,Link:Ot}=o,_t=({metaProcessData:e})=>{const s=A(),t="default"!==z().key,n=B("/:crc/meta_process/:pid/*"),o=[n?.params["*"]],{pid:a,crc:l}=$();return ue.jsx("div",{style:{height:"50px",marginTop:"5px",marginLeft:"20px"},children:ue.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[ue.jsxs("div",{children:[ue.jsxs(Ot,{style:{textDecoration:"none"},onClick:()=>s(t?-1:`/${l}/info`),children:[ue.jsx(m,{style:{color:"#7d7d7d"}})," "]}),ue.jsx(Ft,{style:{fontSize:"16px",color:"#7d7d7d"},children:"Meta"})," ",ue.jsx(Ft,{style:{fontSize:"16px"},children:e?.Message.Info.ID})]}),ue.jsxs("div",{style:{flexGrow:1,display:"flex",justifyContent:"end"},children:[ue.jsx("div",{style:{width:"200px"},children:ue.jsx(u,{onClick:()=>{},selectedKeys:o,mode:"horizontal",items:[{label:ue.jsx(Ft,{style:{fontSize:"14px",color:"#7d7d7d"},children:ue.jsx(F,{to:`/${l}/meta_process/${a?.replace("#","%23")}/info`,children:"Info"})}),key:"info"},{label:ue.jsx(Ft,{style:{fontSize:"14px",color:"#7d7d7d"},children:ue.jsx(F,{to:`/${l}/meta_process/${a?.replace("#","%23")}/inspect`,children:"Inspect"})}),key:"inspect"},{label:ue.jsx(Ft,{style:{fontSize:"14px",color:"#7d7d7d"},children:ue.jsx(F,{to:`/${l}/meta_process/${a?.replace("#","%23")}/log`,children:"Log"})}),key:"log"}]})}),ue.jsx(Bt,{})]})]})})},Vt=Z(({logLevel:e})=>{const{websocketStore:s}=zs(),{pid:t}=$();return ue.jsx(l,{menu:{items:ze,selectedKeys:[e],onSelect:e=>{var n;n=e.key,s.sendMessage(`\n    {\n      "CID": "${P()}",\n      "Command": "do",\n      "Name": "set_log_level",\n      "Args":\n        {"Level":"${n}", "ID":"${t}"}\n    }`)},selectable:!0},trigger:["click"],children:ue.jsxs(o.Link,{children:[ze.find(s=>s.key===e)?.label," ",ue.jsx(h,{})]})})}),Ut=({metaProcessData:e})=>{const s=_e();return ue.jsxs(ye,{children:[ue.jsx(be,{children:ue.jsx(g,{colon:!1,size:"small",items:[{key:"1",label:"Behavior",children:e?.Message.Info.Behavior},{key:"11",label:"Application",children:e?.Message.Info.Application},{key:"2",label:"Parent",children:e?.Message.Info.Parent&&ue.jsx(s,{pid:e.Message.Info.Parent})},{key:"4",label:"Log Level",children:e?.Message.Info.LogLevel&&ue.jsx(Vt,{logLevel:e.Message.Info.LogLevel})}],column:1})}),ue.jsx(be,{children:ue.jsx(g,{colon:!0,size:"small",items:[{key:"0",label:"Mailbox Size",children:-1===e?.Message.Info.MailboxSize?"unlimited":e?.Message.Info.MailboxSize},{key:"1",label:"Message Priority",children:e?.Message.Info.MessagePriority},{key:"2",label:"State",children:e?.Message.Info.State},{key:"3",label:"Uptime",children:e?.Message.Info.Uptime&&ue.jsx(Ve,{uptime:e.Message.Info.Uptime})}],column:1,layout:"horizontal"})})]})},Kt=Z(()=>{const{logsStore:e}=zs(),s=Y(e.metaProcessLogsToRender);return ue.jsx("div",{style:{minHeight:"calc(100vh - 40px - 45px - 80px"},children:ue.jsx("div",{style:{padding:"15px 30px"},children:ue.jsx(js,{logs:s,page:"meta"})})})}),qt=Z(()=>{const{pid:e}=$(),{websocketStore:s,logsStore:t}=zs(),{commonContext:{nodeName:o}}=xe(),[a,l]=n.useState(),[i,r]=n.useState(""),[c,d]=n.useState(),[m,u]=n.useState(""),h=B("/:crc/meta_process/:pid/*"),p=[h?.params["*"]];n.useEffect(()=>{if(o)return s.sendMessage(`{\n      "CID": "${P()}",\n      "Command": "subscribe",\n      "Name": "meta",\n      "Args":\n        {"ID":"${e}"}\n  }`),()=>{s.sendMessage(`\n      {\n        "CID": "${P()}",\n        "Command": "unsubscribe",\n        "Name": "${i}"\n    }`)}},[o,i,e]),n.useEffect(()=>{if(o)return"inspect"===p[0]&&s.sendMessage(`\n      {\n        "CID": "85e5528a-006e-4a82-a26e-6f62b622b604",\n        "Command": "subscribe",\n        "Name": "meta_state",\n        "Args":\n            {"ID":"${e}"}\n    }`),()=>{m&&(s.sendMessage(`\n      {\n        "CID": "${P()}",\n        "Command": "unsubscribe",\n        "Name": "${m}"\n    }`),u(""))}},[o,m,p[0],e]);const x=n.useRef(Array(61).fill({xValue:0,messagesIn:0,messagesInTotal:0,messagesOut:0,messagesOutTotal:0,queueMain:0,queueSystem:0,timeStamp:0}).map((e,s)=>({...e,xValue:60-s}))),y=s=>{var t;if(ve(t=s)&&ke(t)&&void 0!==t.Result&&"object"==typeof t.Result&&"string"==typeof(t?.Result).Event&&t.Result.Event.includes("inspect_meta")&&!t.Result.Event.includes("inspect_meta_state")&&e&&s.Result.Event.includes(e)&&r(s.Result.Event),!Ce(s)&&(e=>ve(e)&&ke(e)&&"string"==typeof e?.Event&&e.Event.includes("inspect_meta")&&!e.Event.includes("inspect_meta_state"))(s)&&e&&s.Event.includes(e)){l(s);const e=x.current.length-1;if(0===x.current[e].messagesInTotal)x.current[e].messagesIn=0,x.current[e].messagesInTotal=s.Message.Info.MessagesIn,x.current[e].messagesOut=0,x.current[e].messagesOutTotal=s.Message.Info.MessagesOut,x.current[e].queueMain=s.Message.Info.MailboxQueues.Main,x.current[e].queueSystem=s.Message.Info.MailboxQueues.System,x.current[e].timeStamp=s.Timestamp;else{const e=x.current.at(-1);if(e){const t=Math.floor((es(s.Timestamp)-es(e.timeStamp))/1e3),n=s.Message.Info.MessagesIn-e.messagesInTotal,o=s.Message.Info.MessagesOut-e.messagesOutTotal;x.current.splice(0,t);for(let e=1;e<=t;e++)e===t?x.current.push({xValue:0,messagesIn:n,messagesInTotal:s.Message.Info.MessagesIn,messagesOut:o,messagesOutTotal:s.Message.Info.MessagesOut,queueMain:s.Message.Info.MailboxQueues.Main,queueSystem:s.Message.Info.MailboxQueues.System,timeStamp:s.Timestamp}):x.current.push({timeStamp:0,xValue:0});x.current=x.current.map((e,s)=>({...e,xValue:60-s}))}}}(e=>ve(e)&&ke(e)&&void 0!==e.Result&&"object"==typeof e.Result&&"string"==typeof(e?.Result).Event&&e.Result.Event.includes("inspect_meta_state"))(s)&&e&&s.Result.Event.includes(e)&&u(s.Result.Event),!Ce(s)&&(e=>ve(e)&&ke(e)&&"string"==typeof e?.Event&&e.Event.includes("inspect_meta_state"))(s)&&e&&s.Event.includes(e)&&d(s),Ce(s)&&l(e=>e?{...e,Message:{...e.Message,Info:{...e.Message.Info,State:"terminated"}}}:void 0)};return n.useEffect(()=>(s.addCallback({type:"initMetaProcessPage",fn:y}),()=>s.removeCallback({type:"initMetaProcessPage"})),[]),n.useLayoutEffect(()=>{t.clearMetaProcessLogs(),t.setMetaProcessFilter(s=>!!e&&xs(s)&&s.Message.Meta.includes(e))},[e]),ue.jsxs("div",{style:{minHeight:"calc(100vh - 27px - 80px"},children:[ue.jsx(_t,{metaProcessData:a}),"info"===p[0]&&ue.jsxs("div",{style:{padding:"5px 25px"},children:[ue.jsx(Ut,{metaProcessData:a}),ue.jsx(ts,{title:"messages"}),ue.jsx(Ze,{chartBuffer:x.current}),ue.jsxs(ye,{children:[ue.jsx(be,{children:ue.jsx(g,{colon:!0,size:"small",items:[{key:"0",label:"Total In",children:a?.Message.Info.MessagesIn}],column:1,layout:"horizontal"})}),ue.jsx(be,{children:ue.jsx(g,{colon:!0,size:"small",items:[{key:"0",label:"Total Out",children:a?.Message.Info.MessagesOut}],column:1,layout:"horizontal"})})]}),ue.jsx(ts,{title:"mailbox queues"}),ue.jsx(Xe,{chartBuffer:x.current}),ue.jsx(ye,{children:ue.jsx(be,{children:" "})})]}),"inspect"===p[0]&&ue.jsx("div",{style:{minHeight:"calc(100vh - 40px - 45px - 80px",padding:"5px 25px"},children:c?.Message.State&&Object.keys(c?.Message.State).length>0?ue.jsx(f,{items:Object.entries(c.Message.State).map(([e,s])=>({key:e,label:e,children:s}))}):ue.jsx(I,{image:I.PRESENTED_IMAGE_SIMPLE})}),"log"===p[0]&&ue.jsx(Kt,{})]})}),{Text:Ht}=o,Wt=()=>ue.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"calc(100vh - 70px - 40px)"},children:ue.jsx(Ht,{children:"No Connection"})}),{Text:Qt}=o,Gt=e=>/\S+@\S+/.test(e),Jt=Z(()=>{const{websocketStore:e}=zs(),[s,t]=n.useState(""),[o,l]=n.useState(!0),[i,c]=n.useState(""),[m,u]=n.useState({Cookie:void 0,Host:void 0,Port:void 0,TLS:void 0}),h=Vs(),[p,g]=n.useState(void 0);n.useEffect(()=>{if(!o)return;const e=h?.[0]?.Name;if(e){g(e);const s=h.find(s=>s.Name===e);s&&t(s.CRC32),l(!1)}},[h?.[0]?.Name,o]);const x=z(),y=A(),b=x.pathname.includes("/process")&&!x.pathname.includes("/processes"),j=x.pathname.includes("/meta_process"),v=x.pathname.split("/").filter((e,s)=>s>1).join("/")||"info",[k,M]=n.useState(),[S,C]=n.useState(!0),I=()=>{const s=P();e.addCallback({type:`changeConnection_${s}`,fn:n=>{if(!Ie(n)||n.CID!==s)return Se(n)&&n.CID===s?(M(void 0),e.removeCallback({type:`changeConnection_${s}`}),u({}),y(b||j?`/${n.Result.CRC32}/info`:`/${n.Result.CRC32}/${v}`),void t("")):void 0;M(n.Error)}}),e.sendMessage(`{\n      "CID": "${s}",\n      "Command": "connect",\n      "Name": "${i}",\n      "Args": ${JSON.stringify(m)}\n    }`)};return ue.jsxs(ue.Fragment,{children:[ue.jsxs(r,{width:350,title:ue.jsx(Qt,{type:"secondary",style:{fontSize:16},children:"Select Node"}),open:h.length>0&&S,onOk:()=>{const n=h.find(e=>e.CRC32===s);if(!n)return;const o=P();e.addCallback({type:`changeConnection_${o}`,fn:n=>{if(!Ie(n)||n.CID!==o)return Se(n)&&n.CID===o?(M(void 0),e.removeCallback({type:`changeConnection_${o}`}),y(b||j?`/${s}/info`:`/${s}/${v}`),void t("")):void 0;M(n.Error)}}),e.sendMessage(`{\n            "CID": "${o}",\n            "Command": "connect",\n            "Name": "${n.Name}"\n          }`)},okText:"Switch",destroyOnClose:!0,onCancel:()=>{C(!1)},children:[k&&ue.jsx("div",{style:{paddingBottom:"15px"},children:ue.jsx(R,{message:k,type:"error",closable:!0,onClose:()=>M(void 0)})}),ue.jsxs(ye,{children:[ue.jsx(Qt,{type:"secondary",children:"Node:"})," ",ue.jsx(d,{value:p,style:{width:180},onChange:e=>{g(e)},options:h.map(({Name:e})=>({value:e,label:e}))})]})]}),ue.jsxs(r,{width:400,title:ue.jsx(Qt,{type:"secondary",style:{fontSize:16},children:"Connect..."}),okButtonProps:{disabled:!Gt(i)},open:0===h.length&&S,onOk:I,okText:"Connect",onCancel:()=>{t(""),u({}),M(void 0),C(!1)},destroyOnClose:!0,children:[k&&ue.jsx("div",{style:{paddingBottom:"15px"},children:ue.jsx(R,{message:k,type:"error",closable:!0,onClose:()=>M(void 0)})}),ue.jsxs(w,{size:"small",name:"basic",labelCol:{span:8},wrapperCol:{span:16},autoComplete:"off",children:[ue.jsx(w.Item,{label:"Remote Node",name:"remoteNode",rules:[{required:!0,message:"Please input remote node name"},({getFieldValue:e})=>({validator:(s,t)=>!t||Gt(e("remoteNode"))?Promise.resolve():Promise.reject(new Error("incorrect nodename"))})],children:ue.jsx(a,{value:i,onChange:e=>c(e.target.value),onKeyDown:e=>{"Enter"===e.key&&Gt(i)&&I()}})}),ue.jsx(f,{items:[{key:"1",label:"options",children:ue.jsxs(ue.Fragment,{children:[ue.jsx(w.Item,{label:"Cookie",name:"cookie",children:ue.jsx(a.Password,{value:m.Cookie,onChange:e=>{const s=e.target.value;u(e=>({...e,Cookie:""===s?void 0:s}))}})}),ue.jsx(w.Item,{label:"Host",name:"host",children:ue.jsx(a,{value:m.Host,onChange:e=>{const s=e.target.value;u(e=>({...e,Host:""===s?void 0:s}))}})}),ue.jsx(w.Item,{label:"Port",name:"port",children:ue.jsx(a,{type:"number",value:m.Port,onChange:e=>{const s=e.target.value;u(e=>({...e,Port:""===s?void 0:Number(s)}))}})}),ue.jsx(w.Item,{label:"Enable TLS",valuePropName:"checked",children:ue.jsx(N,{onChange:e=>u(s=>({...s,TLS:e}))})})]})}]})]})]})]})}),Zt=()=>{const{networkStore:e,processesStore:s,logsStore:t,networkConnectedNodesStore:n,applicationsStore:o}=zs();return()=>{e.tryToSubscribeNetworkData(),s.tryToSubscribeProcessListData(),t.tryToSubscribeLogData(),n.trySetNodes(),o.tryToSubscribeApplicationListData()}},Yt=[{path:"*",element:ue.jsx(Q,{to:"/"})},{path:"/:crc/info",element:ue.jsx("div",{style:{padding:"5px 25px"},children:ue.jsx(Rt,{})})},{path:"/:crc/network",element:ue.jsx("div",{style:{padding:"5px 25px"},children:ue.jsx(Rt,{})})},{path:"/:crc/applications",element:ue.jsx("div",{style:{padding:"5px 25px"},children:ue.jsx(Rt,{})})},{path:"/:crc/processes",element:ue.jsx("div",{style:{padding:"5px 25px"},children:ue.jsx(Rt,{})})},{path:"/:crc/log",element:ue.jsx("div",{style:{padding:"5px 25px"},children:ue.jsx(Rt,{})})},{path:"/:crc/process/:pid/*",element:ue.jsx(Cs,{})},{path:"/:crc/meta_process/:pid/*",element:ue.jsx(qt,{})}],Xt=({children:e})=>ue.jsx(fe,{children:ue.jsx(Fs,{children:ue.jsx(E,{theme:{token:{fontFamily:"Iosevka Web"}},children:e})})}),en=Z(()=>{const{websocketStore:e,nodeStore:s,connectedNodeStore:t,networkConnectedNodesStore:o}=zs(),a=xe(),{commonContext:{CRC32:l}}=a,{crc:i}=$(),r=A(),c=Vs(),d=(()=>{const{networkStore:e,processesStore:s,logsStore:t,networkConnectedNodesStore:n,applicationsStore:o}=zs();return()=>{e.unsubscribeNetworkData(),s.unsubscribeProcessData(),t.unsubscribeLogData(),n.unsubscribeConnectedNodes(),o.unsubscribeApplicationData()}})(),m=Zt(),u=Y(t.nodeData?.Node),h=Boolean(Y(t.nodeData)),p=e.connected,g=location.pathname,[x,f]=n.useState(!1);n.useEffect(()=>{if(p&&!x&&!(l&&l===u?.CRC32||l&&l===i&&s.nodeData)){if(i&&i!==u?.CRC32){const s=c.find(e=>e.CRC32===i);if(!s)return;if(s.CRC32===l)return;return f(!0),e.connectByNodename(s.Name),void setTimeout(()=>f(!1),1e3)}return u?.Name?"/"===g?void r(`/${u.CRC32}/info`,{replace:!0}):(f(!0),e.connectByNodename(u.Name),void setTimeout(()=>f(!1),1e3)):void 0}},[u,p,i,g,c,x]);const y=s.nodeData?.Message.Node;return n.useLayoutEffect(()=>{if(y)return m(),()=>{d(),s.clearCharts(),o.clearStoreData()}},[y]),ue.jsxs(ue.Fragment,{children:[ue.jsx(O,{}),ue.jsx(Hs,{}),ue.jsx("div",{style:{display:"flex",justifyContent:"center",width:"100vw"},children:ue.jsx("div",{style:{width:"850px",borderColor:"black",borderRadius:"3px 3px 0px 0px",background:"#ffffff",paddingTop:"70px",paddingBottom:"40px",minHeight:"calc(100vh - 70px - 40px)"},className:"shadow",children:ue.jsx("div",{style:{display:"flex",flexDirection:"column"},children:y?ue.jsx(_,{},y):ue.jsxs(ue.Fragment,{children:[h&&!u?.Name&&p&&!i&&ue.jsx(Jt,{}),ue.jsx(Wt,{})]})})})}),ue.jsx(Lt,{})]})}),sn=Z(({children:e})=>{const{websocketStore:s,connectedNodeStore:t,networkConnectedNodesStore:o}=zs(),[a,l]=T.useNotification(),[i,r]=n.useState(!1),[c,d]=n.useState(!1),[m,u]=n.useState(!1),h=s.connectionLost,p=Vs();n.useEffect(()=>{h&&(d(!0),t.clearNodeData(),o.clearNodesToSubscribe(),i||(r(!0),a.open({type:"error",message:"Connection lost",description:"Trying to reconnect...",duration:0,key:"connectionLost"})))},[h]);const g=s.connected,x=Zt(),{crc:f}=$();return n.useEffect(()=>{if(g&&(a.destroy("connectionLost"),c&&f&&!m)){const e=p.find(e=>e.CRC32===f);if(!e)return;return u(!0),s.connectByNodename(e.Name),x(),o.resubscribeConnectedNodes(),d(!1),void setTimeout(()=>u(!1),2e3)}},[g,f,p,c,m]),ue.jsxs(ue.Fragment,{children:[l,e]})}),tn=Z(()=>{const{websocketStore:e,nodeStore:s}=zs(),t=s.nodeData?.Message.Node,n=e.connectionLost;return ue.jsxs(V,{children:[ue.jsx(U,{children:ue.jsxs("title",{children:["Observer",t?":":""," ",n?"⚠️ ":"",t?`${t}`:""]})}),ue.jsx(K,{router:q(H(ue.jsx(W,{path:"/",element:ue.jsx(sn,{children:ue.jsx(en,{})}),children:Yt.map(({path:e,element:s})=>ue.jsx(W,{path:e,element:s},e))})))})]})}),nn=()=>ue.jsx(Xt,{children:ue.jsx(tn,{})});pe.createRoot(document.getElementById("root")).render(ue.jsx(L.StrictMode,{children:ue.jsx(nn,{})}));
